# Traefik TCP Router Configuration for Historian PostgreSQL Replication
# This configuration secures the PostgreSQL replication port using Traefik's TCP routing

tcp:
  routers:
    historian-tcp:
      # TCP entrypoint for PostgreSQL connections
      entryPoints:
        - historian
      # Route to the historian PostgreSQL service
      rule: "HostSNI(`*`)"
      service: historian-tcp
      # Enable TLS passthrough - Traefik forwards encrypted traffic to PostgreSQL
      # PostgreSQL handles its own TLS using mounted certificates
      tls:
        passthrough: true

  services:
    historian-tcp:
      loadBalancer:
        servers:
          - address: "historian:5432"

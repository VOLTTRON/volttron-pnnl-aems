"use strict";(self.webpackChunkaems_client=self.webpackChunkaems_client||[]).push([[957],{97957:function(e,n,i){i.r(n),i.d(n,{default:function(){return le}});var t=i(1413),a=i(9153),o=i(93433),l=i(15671),d=i(43144),c=i(60136),r=i(43668),s=i(50698),u=i(32183),h=i(9418),p=i(36625),f=i(4481),v=i(97626),x=i(23122),g=i(763),m=i(99574),j=i(72791),b=i(80184);function y(e){var n,i=e.unit,t=e.editing,a=e.configurations,o=e.handleChange,l=e.handleCreate,d=e.readOnly,c=(0,j.useCallback)((function(e){return(0,g.get)(t,e,(0,g.get)(i,e))}),[t,i]);return(0,b.jsxs)(b.Fragment,{children:[!d&&(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{className:"configuration select",children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("h3",{children:"Select Configuration"}),(0,b.jsx)(m.p,{content:(0,b.jsxs)(h.v2,{children:[(0,b.jsx)(h.sN,{text:"New Configuration",onClick:function(){return l(i)}}),null===a||void 0===a?void 0:a.map((function(e){return(0,b.jsx)(h.sN,{text:e.label,onClick:function(){return o("configurationId",i)(e.id)}},e.id)}))]}),placement:"bottom-start",children:(0,b.jsx)(h.zx,{rightIcon:x.vv6,minimal:!0,children:(null===i||void 0===i||null===(n=i.configuration)||void 0===n?void 0:n.label)||"Select Configuration..."})})]})}),(0,b.jsx)("div",{})]}),(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{className:"label",children:(0,b.jsxs)(h.__,{children:[d?(0,b.jsx)("h3",{children:"Configuration Label"}):(0,b.jsx)("b",{children:"Configuration Label"}),(0,b.jsx)(h.BZ,{type:"text",value:c("configuration.label"),onChange:function(e){return o("configuration.label",t)(e.target.value)},readOnly:d})]})}),(0,b.jsx)("div",{})]})]})}var S=i(29439),C=i(696),N=i(78719),O=i(42632),T=i(72426),R=i.n(T);function M(e){var n,i=e.path,t=e.unit,a=e.editing,o=e.holiday,l=e.handleChange,d=e.readOnly,c=o.id,r=o.label,u=o.type,p=o.month,f=o.day,v=o.observance,m=(0,j.useCallback)((function(e){return(0,g.get)(a,e,(0,g.get)(t,e))}),[a,t]);if("Custom"===u){var y=v&&(null===(n=C.VD.parse(v))||void 0===n?void 0:n.label),S="".concat(R()().set("month",p-1).set("date",f).format("MMMM Do")," ").concat(y&&"(".concat(y,")"));return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:r}),(0,b.jsx)(h.BZ,{type:"text",value:S,readOnly:!0})]})}),(0,b.jsx)("div",{children:(0,b.jsx)(h.zx,{icon:x.R4W,intent:s.S.WARNING,minimal:!0,onClick:function(){l(i,a)({id:c,type:u,action:"delete"})},disabled:d})})]})})}return(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{className:"holiday",children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:r}),(0,b.jsx)(h.XZ,{label:"Enabled",checked:"Enabled"===m("".concat(i,".type")),indeterminate:null==m("".concat(i,".type")),onClick:function(){l("".concat(i),a)({id:m("".concat(i,".id")),type:"Enabled"===m("".concat(i,".type"))?"Disabled":"Enabled"})},disabled:d})]})}),(0,b.jsx)("div",{})]})}var k=i(60364),D=C.R$.values.map((function(e){return e.label})),Z=new Date("2024-01-01");Z.setFullYear(2024,0,1);var z=new Date("2024-12-31");z.setFullYear(2024,11,31);function E(e){var n=e.unit,i=e.editing,t=e.handleChange,a=e.holidays,o=(0,j.useState)(""),l=(0,S.Z)(o,2),d=l[0],c=l[1],r=(0,j.useState)(function(){var e=new Date("2024-01-01");return e.setFullYear(2024,0,1),e}()),u=(0,S.Z)(r,2),p=u[0],f=u[1],v=(0,j.useState)(""),y=(0,S.Z)(v,2),N=y[0],T=y[1],M=(0,j.useState)(!1),k=(0,S.Z)(M,2),D=k[0],E=k[1];return(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{className:"label",children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:"Holiday Label"}),(0,b.jsx)(h.BZ,{type:"text",value:d,onChange:function(e){return c(e.target.value)}})]})}),(0,b.jsx)("div",{children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:"Date"}),(0,b.jsx)(m.p,{content:(0,b.jsx)(O.M,{canClearSelection:!1,minDate:Z,maxDate:z,value:p,onChange:function(e,n){e&&f(e),E(!n)}}),isOpen:D,placement:"bottom-start",children:(0,b.jsx)(h.zx,{rightIcon:x.XNV,onClick:function(){return E(!0)},minimal:!0,children:R()(p).format("MMMM Do")})})]})}),(0,b.jsx)("div",{children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:"Observance"}),(0,b.jsx)(m.p,{content:(0,b.jsxs)(h.v2,{children:[(0,b.jsx)(h.sN,{text:"Always on Date",onClick:function(){return T("")}}),C.VD.values.map((function(e){return(0,b.jsx)(h.sN,{text:e.label,onClick:function(){return T(e.label)}},e.name)}))]}),placement:"bottom-start",children:(0,b.jsx)(h.zx,{rightIcon:x.vv6,minimal:!0,children:N||"Always on Date"})})]})}),(0,b.jsx)("div",{children:(0,b.jsx)(h.zx,{icon:x.YZ9,intent:s.S.PRIMARY,minimal:!0,disabled:(0,g.isEmpty)(d)||void 0!==a.find((function(e){return e.label===d})),onClick:function(){var e,a=Math.max((0,g.get)(n,"configuration.holidays.length",0),(0,g.get)(i,"configuration.holidays.length",0));t("configuration.holidays.".concat(a),i)({type:"Custom",label:d,month:p.getMonth()+1,day:p.getDate(),observance:N,configurationId:null===n||void 0===n||null===(e=n.configuration)||void 0===e?void 0:e.id,createdAt:R()().format(),action:"create"}),c(""),f(new Date),T("")},children:"Create Holiday"})})]})}function A(e){var n,i=e.unit,t=e.editing,a=e.handleChange,o=e.readOnly,l=(0,k.I0)(),d=(0,j.useState)(void 0),c=(0,S.Z)(d,2),r=c[0],u=c[1],p=(0,g.merge)([],null===(n=i.configuration)||void 0===n?void 0:n.holidays,(0,g.get)(t,"configuration.holidays"));return p.forEach((function(e,n){return e.index=n})),(0,b.jsxs)(b.Fragment,{children:[!o&&(0,b.jsxs)(h.__,{children:[(0,b.jsx)("h3",{children:"Create Holiday"}),(0,b.jsx)(E,{unit:i,editing:t,handleChange:a,holidays:p})]}),(0,b.jsxs)(h.__,{children:[(0,b.jsx)("h3",{children:"Custom Holidays"}),(0,b.jsx)("ul",{children:(0,g.isEmpty)(p.filter((function(e){return"Custom"===e.type&&"delete"!==e.action})))?(0,b.jsx)("li",{children:"No Custom Holidays Defined"},"empty"):p.filter((function(e){return"Custom"===e.type&&"delete"!==e.action})).sort((function(e,n){return R()(n.createdAt).valueOf()-R()(e.createdAt).valueOf()})).map((function(e,n){return(0,b.jsx)("li",{children:(0,b.jsx)(M,{path:"configuration.holidays.".concat(e.index),unit:i,editing:t,holiday:e,handleChange:a,readOnly:o},e.index)},e.index)}))})]}),(0,b.jsxs)(h.__,{children:[(0,b.jsx)("h3",{children:"Predefined Holidays"}),(0,b.jsx)("ul",{children:p.filter((function(e){return"Custom"!==e.type})).sort((function(e,n){return D.indexOf(e.label)-D.indexOf(n.label)})).map((function(e,n){return(0,b.jsx)("li",{children:(0,b.jsx)(M,{path:"configuration.holidays.".concat(e.index),unit:i,editing:t,holiday:e,handleChange:a,readOnly:o},e.index)},e.index)}))})]}),(0,b.jsx)(h.bZ,{intent:s.S.DANGER,isOpen:void 0!==r,confirmButtonText:"Yes",cancelButtonText:"Cancel",onConfirm:function(){var e;return l((0,N.qd)(null!==(e=null===r||void 0===r?void 0:r.id)&&void 0!==e?e:-1))},onClose:function(){return u(void 0)},children:(0,b.jsxs)("p",{children:["Permanently delete the holiday ",null===r||void 0===r?void 0:r.label,"?"]})})]})}var _=i(63769),L=i(48565);function B(e){var n=e.path,i=e.editing,t=e.occupancy,a=e.handleChange,o=t.id,l=t.label,d=t.date,c=t.schedule,r=null===c||void 0===c?void 0:c.label,u="".concat(R()(d).format("dddd MMMM Do YYYY")," ").concat(r&&"(".concat(r,")")),p=R()(d).startOf("day").isBefore(R()().startOf("day"),"day");return(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{children:(0,b.jsxs)(h.__,{disabled:p,children:[(0,b.jsx)("b",{children:l}),(0,b.jsx)(h.BZ,{type:"text",value:u,disabled:p,readOnly:!0})]})}),(0,b.jsx)("div",{children:(0,b.jsx)(h.zx,{icon:x.R4W,intent:s.S.WARNING,minimal:!0,onClick:function(){a(n,i)({id:o,action:"delete"})}})})]})})}var P,I=i(50668),U=(0,I.parseBoolean)("false"),w={label:"",occupied:!0,startTime:(0,_.cz)(_.S$),endTime:(0,_.cz)(_.Be)};function $(e){var n=e.unit,i=e.editing,t=e.handleChange,a=(0,j.useState)(""),o=(0,S.Z)(a,2),l=o[0],d=o[1],c=(0,j.useState)(new Date),r=(0,S.Z)(c,2),u=r[0],p=r[1],f=(0,j.useState)((0,g.clone)(w)),v=(0,S.Z)(f,2),y=v[0],C=v[1],N=(0,j.useState)(!1),T=(0,S.Z)(N,2),M=T[0],k=T[1],D=(0,j.useCallback)((function(e){return(0,g.get)(i,e,(0,g.get)(n,e))}),[i,n]),Z=R()(u).format("dddd").toLowerCase(),z={schedule:{start:y.occupied?(0,_.xM)(y.startTime,!1):_.lL,end:y.occupied?(0,_.xM)(y.endTime,!0):_.QM},previous:{start:D("configuration.".concat(Z,"Schedule.occupied"))?(0,_.xM)(D("configuration.".concat(Z,"Schedule.startTime")),!1):_.lL,end:D("configuration.".concat(Z,"Schedule.occupied"))?(0,_.xM)(D("configuration.".concat(Z,"Schedule.endTime")),!0):_.QM,occupied:D("configuration.".concat(Z,"Schedule.occupied"))}};return(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{className:"label",children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:"Occupancy Label"}),(0,b.jsx)(h.BZ,{type:"text",value:l,onChange:function(e){return d(e.target.value)}})]})}),(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{className:"label",children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:"Occupancy Schedule"}),(0,b.jsx)(h.BZ,{type:"text",value:y.label,readOnly:!0})]})}),(0,b.jsx)("div",{className:"occupancy",children:(0,b.jsxs)(h.Zz,{min:_.lL,max:_.QM,stepSize:5,labelStepSize:240,labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>_.lL&&e<_.QM?(0,_.li)(e):""},disabled:!y.occupied,children:[(0,b.jsx)(h.Zz.Handle,{type:h.gZ.START,interactionKind:h.qB.LOCK,intentAfter:y.occupied?s.S.SUCCESS:s.S.NONE,value:z.schedule.start,onChange:function(e){var n=(0,g.cloneDeep)(y),i=y.occupied,t=(0,_.xM)(y.endTime,!0),a=(0,g.clamp)(e,_.lL,Math.min(t,_.QM)-_.Ls),o=(0,_.sG)("all",{occupied:i,startTime:a,endTime:t});(0,g.merge)(n,{startTime:(0,_.cz)(a),label:o}),C(n)}}),(0,b.jsx)(h.Zz.Handle,{type:h.gZ.START,interactionKind:h.qB.NONE,intentAfter:z.previous.occupied?(0,g.inRange)(z.previous.start,z.schedule.start,z.schedule.end)?s.S.SUCCESS:s.S.PRIMARY:s.S.NONE,value:z.previous.start}),(0,b.jsx)(h.Zz.Handle,{type:h.gZ.END,interactionKind:h.qB.NONE,intentBefore:z.previous.occupied?(0,g.inRange)(z.previous.end,z.schedule.start,z.schedule.end)?s.S.SUCCESS:s.S.PRIMARY:s.S.NONE,value:z.previous.end}),(0,b.jsx)(h.Zz.Handle,{type:h.gZ.END,interactionKind:h.qB.LOCK,intentBefore:y.occupied?s.S.SUCCESS:s.S.NONE,value:z.schedule.end,onChange:function(e){var n=(0,g.cloneDeep)(y),i=y.occupied,t=(0,_.xM)(y.startTime,!1),a=(0,g.clamp)(e,Math.max(t,_.lL)+_.Ls,_.QM),o=(0,_.sG)("all",{occupied:i,startTime:t,endTime:a});(0,g.merge)(n,{endTime:(0,_.cz)(a),label:o}),C(n)}})]})}),U?(0,b.jsx)("div",{className:"unoccupied",children:(0,b.jsx)(h.XZ,{label:"Unoccupied",checked:!y.occupied,onClick:function(){var e=(0,g.cloneDeep)(y),n=!y.occupied,i=(0,_.xM)(y.startTime,!1),t=(0,_.xM)(y.endTime,!0),a=(0,_.sG)("all",{occupied:n,startTime:i,endTime:t});(0,g.merge)(e,{occupied:n,label:a}),C(e)}})}):(0,b.jsx)("div",{})]}),(0,b.jsx)("div",{children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:"Date"}),(0,b.jsx)(m.p,{content:(0,b.jsx)(O.M,{value:u,onChange:function(e,n){e&&p(e),k(!n)}}),isOpen:M,placement:"bottom-start",children:(0,b.jsx)(h.zx,{rightIcon:x.XNV,onClick:function(){return k(!0)},minimal:!0,children:R()(u).format("dddd MMMM Do YYYY")})})]})}),(0,b.jsx)("div",{children:(0,b.jsx)(h.zx,{icon:x.YZ9,intent:s.S.PRIMARY,minimal:!0,onClick:function(){var e,a=Math.max((0,g.get)(n,"configuration.occupancies.length",0),(0,g.get)(i,"configuration.occupancies.length",0));t("configuration.occupancies.".concat(a),i)({label:l,date:u.toISOString(),schedule:y,configurationId:null===n||void 0===n||null===(e=n.configuration)||void 0===e?void 0:e.id,createdAt:R()().format(),action:"create"}),d(""),p(new Date),C((0,g.clone)(w))},children:"Create Occupancy"})})]})}function H(e){var n,i=e.unit,t=e.editing,a=e.handleChange,o=(0,k.I0)(),l=(0,j.useState)(void 0),d=(0,S.Z)(l,2),c=d[0],r=d[1],u=(0,g.merge)([],null===(n=i.configuration)||void 0===n?void 0:n.occupancies,(0,g.get)(t,"configuration.occupancies"));return u.forEach((function(e,n){return e.index=n})),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(h.__,{children:[(0,b.jsx)("h3",{children:"Create Occupancy"}),(0,b.jsx)($,{unit:i,editing:t,handleChange:a})]}),(0,b.jsxs)(h.__,{children:[(0,b.jsx)("h3",{children:"Temporary Occupancies"}),(0,b.jsx)("ul",{children:(0,g.isEmpty)(u.filter((function(e){return"delete"!==e.action})))?(0,b.jsx)("li",{children:"No Temporary Occupancies Defined"},"empty"):u.filter((function(e){return"delete"!==e.action})).sort((function(e,n){return R()(n.date).valueOf()-R()(e.date).valueOf()})).map((function(e,n){return(0,b.jsx)("li",{children:(0,b.jsx)(B,{path:"configuration.occupancies.".concat(e.index),unit:i,editing:t,occupancy:e,handleChange:a},e.index)},e.index)}))})]}),(0,b.jsx)(h.bZ,{intent:s.S.DANGER,isOpen:void 0!==c,confirmButtonText:"Yes",cancelButtonText:"Cancel",onConfirm:function(){var e;return o((0,L.VT)(null!==(e=null===c||void 0===c?void 0:c.id)&&void 0!==e?e:-1))},onClose:function(){return r(void 0)},children:(0,b.jsxs)("p",{children:["Permanently delete the occupancy ",null===c||void 0===c?void 0:c.label,"?"]})})]})}function Y(e){var n=e.title,i=e.path,t=e.unit,a=e.editing,o=e.handleChange,l=e.readOnly,d=void 0===l?["title"]:l,c=(0,j.useCallback)((function(e){return(0,g.get)(a,e,(0,g.get)(t,e))}),[a,t]);return(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("h3",{children:" "}),(0,b.jsx)("div",{className:"label",children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:n}),(0,b.jsx)(h.BZ,{type:"text",value:c("".concat(i,".label")),onChange:function(e){o("".concat(i,".label"),a)(e.target.value)},readOnly:null===d||void 0===d?void 0:d.includes("title")})]})}),(0,b.jsx)("div",{className:"schedule",children:(0,b.jsx)(h.U2,{min:_.lL,max:_.QM,stepSize:5,labelStepSize:240,intent:s.S.SUCCESS,value:c("".concat(i,".occupied"))?[(0,_.xM)(c("".concat(i,".startTime")),!1),(0,_.xM)(c("".concat(i,".endTime")),!0)]:[_.lL,_.lL],labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>_.lL&&e<_.QM?(0,_.li)(e):""},disabled:(null===d||void 0===d?void 0:d.includes("occupied"))||!(0,g.get)(a,"".concat(i,".occupied"),(0,g.get)(t,"".concat(i,".occupied"))),onChange:function(e){var n=c("".concat(i,".occupied")),t=(0,g.clamp)(e[0],_.lL,Math.min(e[1],_.QM)-_.Ls),l=(0,g.clamp)(e[1],Math.max(e[0],_.lL)+_.Ls,_.QM),d=(0,_.sG)("all",{occupied:n,startTime:t,endTime:l});o("".concat(i),a)({startTime:(0,_.cz)(t),endTime:(0,_.cz)(l),label:d})}})}),(0,b.jsx)("div",{className:"unoccupied",children:(0,b.jsx)(h.XZ,{label:"Unoccupied",checked:!c("".concat(i,".occupied")),onClick:function(){var e=!c("".concat(i,".occupied")),n=(0,_.xM)(c("".concat(i,".startTime")),!1),t=(0,_.xM)(c("".concat(i,".endTime")),!0),l=(0,_.sG)("all",{occupied:e,startTime:n,endTime:t});o("".concat(i),a)({occupied:e,label:l})},disabled:null===d||void 0===d?void 0:d.includes("unoccupied")})})]})}w.label=(0,_.sG)("all",w);var G=(0,I.parseBoolean)(null!==(P="false")?P:"");function K(e){var n=e.unit,i=e.editing,t=e.handleChange,a=e.readOnly;return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(Y,{title:"Monday Schedule",path:"configuration.mondaySchedule",unit:n,editing:i,handleChange:t,readOnly:a?["title","occupied","unoccupied"]:void 0}),(0,b.jsx)(Y,{title:"Tuesday Schedule",path:"configuration.tuesdaySchedule",unit:n,editing:i,handleChange:t,readOnly:a?["title","occupied","unoccupied"]:void 0}),(0,b.jsx)(Y,{title:"Wednesday Schedule",path:"configuration.wednesdaySchedule",unit:n,editing:i,handleChange:t,readOnly:a?["title","occupied","unoccupied"]:void 0}),(0,b.jsx)(Y,{title:"Thursday Schedule",path:"configuration.thursdaySchedule",unit:n,editing:i,handleChange:t,readOnly:a?["title","occupied","unoccupied"]:void 0}),(0,b.jsx)(Y,{title:"Friday Schedule",path:"configuration.fridaySchedule",unit:n,editing:i,handleChange:t,readOnly:a?["title","occupied","unoccupied"]:void 0}),(0,b.jsx)(Y,{title:"Saturday Schedule",path:"configuration.saturdaySchedule",unit:n,editing:i,handleChange:t,readOnly:a?["title","occupied","unoccupied"]:void 0}),(0,b.jsx)(Y,{title:"Sunday Schedule",path:"configuration.sundaySchedule",unit:n,editing:i,handleChange:t,readOnly:a?["title","occupied","unoccupied"]:void 0}),G&&(0,b.jsx)(Y,{title:"Holiday Schedule",path:"configuration.holidaySchedule",unit:n,editing:i,handleChange:t,readOnly:a?["title","occupied","unoccupied"]:void 0})]})}var F=i(49107);function q(e){var n=e.type,i=e.title,t=e.path,a=e.unit,o=e.editing,l=e.setpoint,d=e.handleChange,c=e.readOnly,r=void 0===c?["title"]:c,u=(0,j.useCallback)((function(e){return(0,g.get)(o,e,(0,g.get)(a,e))}),[o,a]),p=(0,j.useMemo)((function(){return(0,F.qr)((0,g.merge)({},(0,g.get)(a,t),l))||"\xa0"}),[t,a,l]),f=function(){return(0,b.jsxs)(h.Zz,{min:F.QG,max:F.Of,stepSize:.5,labelStepSize:5,labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>F.op&&e<F.Ig?"".concat(e,"\xba\xa0F"):""},children:[(0,b.jsx)(h.Zz.Handle,{type:h.gZ.START,interactionKind:h.qB.LOCK,intentAfter:s.S.WARNING,value:u("".concat(t,".heating")),onChange:function(e){var n=u("".concat(t,".setpoint")),i=u("".concat(t,".deadband")),a=F.ax+i/2,l=(0,g.clamp)(e,F.op,n-a),c=u("".concat(t,".cooling")),r=(0,F.hD)("all",{setpoint:n,deadband:i,heating:l,cooling:c});d("".concat(t),o)({heating:l,label:r})}}),(0,b.jsx)(h.Zz.Handle,{type:h.gZ.START,interactionKind:h.qB.LOCK,intentAfter:s.S.NONE,value:u("".concat(t,".setpoint"))-u("".concat(t,".deadband"))/2,onChange:function(e){var n=u("".concat(t,".deadband")),i=F.ax+n/2,a=u("".concat(t,".heating")),l=u("".concat(t,".cooling")),c=e+n/2,r=(0,g.clamp)(c,a+i,l-i),s=(0,F.hD)("all",{setpoint:r,deadband:n,heating:a,cooling:l});d("".concat(t),o)({setpoint:r,label:s})}}),(0,b.jsx)(h.Zz.Handle,{type:h.gZ.END,interactionKind:h.qB.LOCK,intentBefore:s.S.NONE,value:u("".concat(t,".setpoint"))+u("".concat(t,".deadband"))/2,onChange:function(e){var n=u("".concat(t,".deadband")),i=F.ax+n/2,a=u("".concat(t,".heating")),l=u("".concat(t,".cooling")),c=e-n/2,r=(0,g.clamp)(c,a+i,l-i),s=(0,F.hD)("all",{setpoint:r,deadband:n,heating:a,cooling:l});d("".concat(t),o)({setpoint:r,label:s})}}),(0,b.jsx)(h.Zz.Handle,{type:h.gZ.END,interactionKind:h.qB.LOCK,intentBefore:s.S.PRIMARY,value:u("".concat(t,".cooling")),onChange:function(e){var n=u("".concat(t,".setpoint")),i=u("".concat(t,".deadband")),a=F.ax+i/2,l=u("".concat(t,".heating")),c=(0,g.clamp)(e,n+a,F.Ig),r=(0,F.hD)("all",{setpoint:n,deadband:i,heating:l,cooling:c});d("".concat(t),o)({cooling:c,label:r})}})]})},v=function(){return(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:"Occupied"}),(0,b.jsxs)(h.Zz,{min:F.QG,max:F.Of,stepSize:.5,labelStepSize:5,intent:s.S.SUCCESS,labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>F.op&&e<F.Ig?"".concat(e,"\xba\xa0F"):""},children:[(0,b.jsx)(h.Zz.Handle,{type:h.gZ.START,interactionKind:h.qB.LOCK,intentBefore:s.S.WARNING,intentAfter:s.S.SUCCESS,value:u("".concat(t,".setpoint"))-u("".concat(t,".deadband"))/2,onChange:function(e){var n=u("".concat(t,".deadband")),i=F.ax+n/2,a=u("".concat(t,".heating")),l=u("".concat(t,".cooling")),c=e+n/2,r=(0,g.clamp)(c,a+i,l-i),s=(0,F.hD)("all",{setpoint:r,deadband:n,heating:a,cooling:l});d("".concat(t),o)({setpoint:r,label:s})}}),(0,b.jsx)(h.Zz.Handle,{type:h.gZ.END,interactionKind:h.qB.LOCK,intentBefore:s.S.SUCCESS,intentAfter:s.S.PRIMARY,value:u("".concat(t,".setpoint"))+u("".concat(t,".deadband"))/2,onChange:function(e){var n=u("".concat(t,".deadband")),i=F.ax+n/2,a=u("".concat(t,".heating")),l=u("".concat(t,".cooling")),c=e-n/2,r=(0,g.clamp)(c,a+i,l-i),s=(0,F.hD)("all",{setpoint:r,deadband:n,heating:a,cooling:l});d("".concat(t),o)({setpoint:r,label:s})}})]})]})},x=function(){return(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:"Unoccupied"}),(0,b.jsxs)(h.Zz,{min:F.QG,max:F.Of,stepSize:.5,labelStepSize:5,labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>F.op&&e<F.Ig?"".concat(e,"\xba\xa0F"):""},children:[(0,b.jsx)(h.Zz.Handle,{type:h.gZ.START,interactionKind:h.qB.LOCK,intentBefore:s.S.WARNING,value:u("".concat(t,".heating")),onChange:function(e){var n=u("".concat(t,".setpoint")),i=u("".concat(t,".deadband")),a=F.ax+i/2,l=(0,g.clamp)(e,F.op,n-a),c=u("".concat(t,".cooling")),r=(0,F.hD)("all",{setpoint:n,deadband:i,heating:l,cooling:c});d("".concat(t),o)({heating:l,label:r})}}),(0,b.jsx)(h.Zz.Handle,{type:h.gZ.END,interactionKind:h.qB.LOCK,intentAfter:s.S.PRIMARY,value:u("".concat(t,".cooling")),onChange:function(e){var n=u("".concat(t,".setpoint")),i=u("".concat(t,".deadband")),a=F.ax+i/2,l=u("".concat(t,".heating")),c=(0,g.clamp)(e,n+a,F.Ig),r=(0,F.hD)("all",{setpoint:n,deadband:i,heating:l,cooling:c});d("".concat(t),o)({cooling:c,label:r})}})]})]})};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("h3",{children:" "}),(0,b.jsx)("div",{className:"label",children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:i}),(0,b.jsx)(h.BZ,{type:"text",value:u("".concat(t,".label")),onChange:function(e){d("".concat(t,".label"),o)(e.target.value)},readOnly:null===r||void 0===r?void 0:r.includes("title")})]})}),(0,b.jsx)("div",{className:"deadband",children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:"Deadband"}),(0,b.jsx)(h.Af,{step:1,min:F.bM,max:F.iz,value:u("".concat(t,".deadband")),onValueChange:function(e){var n=u("".concat(t,".setpoint")),i=e,a=u("".concat(t,".heating")),l=u("".concat(t,".cooling")),c=(0,F.hD)("all",{setpoint:n,deadband:i,heating:a,cooling:l});d("".concat(t),o)({deadband:i,label:c})}})]})}),(0,b.jsx)("div",{className:"error",children:(0,b.jsx)("h4",{children:p})}),(0,b.jsx)("div",{})]}),function(){switch(n){case"both":return(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{className:"setpoint",children:f()}),(0,b.jsx)("div",{className:"break"}),(0,b.jsx)("div",{className:"setpoint",children:v()}),(0,b.jsx)("div",{className:"break"}),(0,b.jsx)("div",{className:"setpoint",children:x()}),(0,b.jsx)("div",{className:"break"}),(0,b.jsx)("div",{})]});case"single":return(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{className:"setpoint",children:f()}),(0,b.jsx)("div",{className:"break"}),(0,b.jsx)("div",{})]});default:return(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{className:"setpoint",children:v()}),(0,b.jsx)("div",{className:"break"}),(0,b.jsx)("div",{className:"setpoint",children:x()}),(0,b.jsx)("div",{className:"break"}),(0,b.jsx)("div",{})]})}}()]})}function Q(e){var n=e.unit,i=e.editing,t=e.handleChange;return(0,b.jsx)(q,{type:"separate",title:"Setpoints",path:"configuration.setpoint",unit:n,editing:i,setpoint:(0,g.get)(i,"configuration.setpoint"),handleChange:t})}var W=i(95785),V=i(53381),X=i(77848),J=i(24824),ee=i(89521),ne=i(37762);i(87757);Symbol("Removed");function ie(e,n){if(0!==e.length){if(1===e.length)return e[0];var i,t={},a=g.union.apply(void 0,(0,o.Z)(e.map((function(e){return function(e){return Object.keys(e)}(e)})))).filter((function(e){return!(null!==n&&void 0!==n&&n.includes(e.toString()))})),l=(0,ne.Z)(a);try{var d=function(){var n=i.value,a=e.map((function(e){return e[n]}));(0,g.every)(a,(function(e){return(0,g.isEqual)(a[0],e)}))&&(t[n]=a[0])};for(l.s();!(i=l.n()).done;)d()}catch(c){l.e(c)}finally{l.f()}return t}}var te=function(e){(0,c.Z)(i,e);var n=(0,r.Z)(i);function i(e){var a,o;(0,l.Z)(this,i),(o=n.call(this,e)).configRouteIsHidden=void 0,o.getValue=function(e,n,i){var t=o.props.units,a=i||(null===t||void 0===t?void 0:t.find((function(e){return e.id===(null===n||void 0===n?void 0:n.id)})));return(0,g.get)(n,e,(0,g.get)(a,e))},o.handleChange=function(e,n){return function(i){if("configurationId"===e)o.props.updateUnit({id:null===n||void 0===n?void 0:n.id,configurationId:i});else!function(i){n&&((0,g.isObject)(o.getValue(e,n))?(0,g.set)(n,e,(0,g.merge)((0,g.cloneDeep)((0,g.get)(n,e)),i)):(0,g.set)(n,e,i),o.setState({editing:n}))}(i)}},o.handleCreate=function(e){var n=(0,X.ER)();n.unitId=e.id,o.props.createConfiguration(n),o.setState({editing:null,expanded:null})},o.handleEdit=function(e){var n=o.props.filtered,i=o.state.editing,t=i&&(null===n||void 0===n?void 0:n.find((function(e){return e.id===i.id})));t&&o.isSave(t)?o.setState({confirm:function(){return o.setState({editing:{id:e.id}})}}):o.setState({editing:{id:e.id}})},o.handleCancel=function(){var e=o.props.filtered,n=o.state.editing,i=n&&(null===e||void 0===e?void 0:e.find((function(e){return e.id===n.id})));i&&o.isSave(i)?o.setState({confirm:function(){return o.setState({editing:null,expanded:null})}}):o.setState({editing:null,expanded:null})},o.handleConfirm=function(){var e=o.state.confirm;o.setState({confirm:null},null!==e&&void 0!==e?e:void 0)},o.handleSave=function(){var e=o.state.editing;e&&(o.props.updateUnit(e),o.setState({editing:null,expanded:null}))},o.handleClearAll=function(){o.setState({editingAll:{configuration:{holidays:C.R$.values.map((function(){return{}}))}},expanded:null})},o.handleSaveAll=function(){var e=o.state.editingAll,n=o.props.filtered;e&&(null===n||void 0===n||n.forEach((function(n){var i,a,l,d,c=n.id,r={name:null===(i=e.location)||void 0===i?void 0:i.name,latitude:null===(a=e.location)||void 0===a?void 0:a.latitude,longitude:null===(l=e.location)||void 0===l?void 0:l.longitude},s={id:null===(d=n.configuration)||void 0===d?void 0:d.id,holidays:C.R$.values.map((function(i,t){var a,o,l,d,c,r,s=null===(a=e.configuration)||void 0===a||null===(o=a.holidays)||void 0===o||null===(l=o[t])||void 0===l?void 0:l.type;return s?{id:null===(d=n.configuration)||void 0===d||null===(c=d.holidays)||void 0===c||null===(r=c.find((function(e){return(null===e||void 0===e?void 0:e.label)===(null===i||void 0===i?void 0:i.label)})))||void 0===r?void 0:r.id,type:s}:void 0})).filter((function(e){return e}))};(r.name||s.holidays.length)&&o.props.updateUnit((0,t.Z)((0,t.Z)({id:c},r.name?{location:r}:{}),s.holidays.length?{configuration:s}:{}))})),o.handleClearAll())},o.handleDelete=function(e){var n=e.id;void 0!==n&&o.props.deleteConfiguration(n)},o.handlePush=function(e){var n=e.id;void 0!==n&&o.props.updateUnit({id:n,stage:C.$b.UpdateType.label})},o.isSave=function(e,n){var i,t;n=null!==(i=n)&&void 0!==i?i:o.state.editing;var a=(0,g.merge)({},e,n);return(null===(t=a.configuration)||void 0===t||!t.setpoint||(0,F.hQ)(a.configuration.setpoint))&&!(0,g.isEqualWith)(e,a,(function(e,n,i){return!!["createdAt","updatedAt","action"].includes(i)||void 0}))},o.isPush=function(e){switch(e.stage){case C.$b.UpdateType.label:case C.$b.DeleteType.label:case C.$b.ProcessType.label:return!1;case C.$b.CreateType.label:case C.$b.CompleteType.label:case C.$b.FailType.label:default:return!o.isSave(e)}};var d=null===(a=Object.values(e.routes.map).find((function(e){var n;return"configuration"===(null===(n=e.data)||void 0===n?void 0:n.name)})))||void 0===a?void 0:a.data;return o.configRouteIsHidden=!(null===d||void 0===d||!d.hidden),o.state={editing:null,editingAll:{configuration:{holidays:C.R$.values.map((function(){return{}}))}},expanded:null,confirm:null},o}return(0,d.Z)(i,[{key:"componentDidMount",value:function(){this.props.readUnits(),this.props.readUnitsPoll(J.Jd),this.configRouteIsHidden||(this.props.readConfigurations(),this.props.readConfigurationsPoll(J.Jd))}},{key:"componentWillUnmount",value:function(){this.props.readUnitsPoll(),this.props.readConfigurationsPoll()}},{key:"isAdmin",value:function(){var e,n,i=this.props.user;return(e=C.GD.Admin).granted.apply(e,(0,o.Z)(null!==(n=null===i||void 0===i?void 0:i.role.split(" "))&&void 0!==n?n:[""]))}},{key:"renderStatus",value:function(e){var n=this,i=x.WNC,t=s.S.WARNING;switch(e.stage){case C.$b.UpdateType.label:i=x.RGM,t=s.S.PRIMARY;break;case C.$b.ProcessType.label:i=x.RGM,t=s.S.SUCCESS;break;case C.$b.CreateType.label:i=x.WNC,t=s.S.WARNING;break;case C.$b.DeleteType.label:i=x.yY6,t=s.S.DANGER;break;case C.$b.CompleteType.label:i=x.ae_,t=s.S.SUCCESS;break;case C.$b.FailType.label:i=x.pnR,t=s.S.DANGER}return(0,b.jsx)(W.u,{content:"Push Unit Configuration",placement:u.Ly.TOP,disabled:!this.isPush(e),children:(0,b.jsx)(h.zx,{icon:i,intent:t,minimal:!0,onClick:function(){return n.handlePush(e)},disabled:!this.isPush(e)})})}},{key:"renderConfirm",value:function(){var e=this;return null===this.state.confirm?null:(0,b.jsx)(h.bZ,{intent:s.S.DANGER,isOpen:!0,confirmButtonText:"Yes",cancelButtonText:"Cancel",onConfirm:function(){return e.handleConfirm()},onClose:function(){return e.setState({confirm:null})},children:(0,b.jsx)("p",{children:"There are changes which have not been saved. Do you still want to continue?"})})}},{key:"renderPrompt",value:function(){var e=this.props.filtered,n=this.state.editing,i=n&&(null===e||void 0===e?void 0:e.find((function(e){return e.id===n.id}))),t=!(0,g.isNil)(i)&&this.isSave(i);return(0,b.jsx)(p.NL,{when:t,message:"There are changes which have not been saved. Do you still want to continue?"})}},{key:"render",value:function(){var e,n,i,a=this,o=this.props,l=o.filtered,d=o.configurations,c=this.state,r=c.editingAll,f=c.editing,v=c.expanded;(null!==(e=(0,g.cloneDeep)(l))&&void 0!==e?e:[]).forEach((function(e){e.configuration.holidays=C.R$.values.map((function(n){var i,t,a;return null!==(i=null===(t=e.configuration)||void 0===t||null===(a=t.holidays)||void 0===a?void 0:a.find((function(e){return(null===e||void 0===e?void 0:e.label)===n.label})))&&void 0!==i?i:{}}))}));var m={location:l?ie(l.map((function(e){var n;return null!==(n=e.location)&&void 0!==n?n:{}})),["createdAt","updatedAt","action","terms"]):{},configuration:{holidays:C.R$.values.map((function(e){return l?ie(l.map((function(n){var i,t,a;return null!==(i=null===(t=n.configuration)||void 0===t||null===(a=t.holidays)||void 0===a?void 0:a.find((function(n){return(null===n||void 0===n?void 0:n.label)===e.label})))&&void 0!==i?i:{}})),["createdAt","updatedAt","action","terms"]):{}}))}};return(0,b.jsxs)("div",{className:"units",children:[this.renderPrompt(),(0,b.jsx)(p.h4,(0,t.Z)({},this.props)),m&&(0,b.jsx)("div",{className:"list padding",children:(0,b.jsxs)(h.Zb,{interactive:!0,children:[(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{children:(0,b.jsx)(h.__,{children:(0,b.jsx)("h3",{children:"Update All Units"})})}),(0,b.jsx)("div",{children:this.isSave(m,r)?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(W.u,{content:"Save",placement:u.Ly.TOP,children:(0,b.jsx)(h.zx,{icon:x.$eC,intent:s.S.PRIMARY,minimal:!0,onClick:function(){return a.handleSaveAll()}})}),(0,b.jsx)(W.u,{content:"Exit",placement:u.Ly.TOP,children:(0,b.jsx)(h.zx,{icon:x.eV6,intent:s.S.PRIMARY,minimal:!0,onClick:function(){return a.handleClearAll()}})})]}):null})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(h.mp,{contents:[{id:"holidays-all",label:"Holidays",icon:x.$qo,hasCaret:!0,isExpanded:"holidays-all"===v}],onNodeExpand:function(e){return a.setState({expanded:e.id})},onNodeCollapse:function(){return a.setState({expanded:null})},onNodeClick:function(e){return a.setState({expanded:e.id===v?null:e.id})}}),(0,b.jsx)(h.UO,{isOpen:"holidays-all"===v,children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("h3",{children:"Predefined Holidays"}),(0,b.jsx)("ul",{children:null===m||void 0===m||null===(n=m.configuration)||void 0===n||null===(i=n.holidays)||void 0===i?void 0:i.map((function(e,n){var i;return(0,b.jsx)("li",{children:(0,b.jsx)(M,{path:"configuration.holidays.".concat(n),unit:m,editing:r,holiday:e,handleChange:a.handleChange,readOnly:!a.isAdmin()},null===e||void 0===e?void 0:e.label)},null!==(i=null===e||void 0===e?void 0:e.label)&&void 0!==i?i:n)}))})]})}),(0,b.jsx)(h.mp,{contents:[{id:"configuration-all",label:"Configuration",icon:x.$qo,hasCaret:!0,isExpanded:"configuration-all"===v}],onNodeExpand:function(e){return a.setState({expanded:e.id})},onNodeCollapse:function(){return a.setState({expanded:null})},onNodeClick:function(e){return a.setState({expanded:e.id===v?null:e.id})}}),(0,b.jsx)(h.UO,{isOpen:"configuration-all"===v,children:(0,b.jsx)(V.f,{unit:m,editing:r,handleChange:this.handleChange,hidden:["label","peakLoadExclude","coolingPeakOffset","heatingPeakOffset","zoneLocation","zoneMass","zoneOrientation","zoneBuilding","coolingCapacity","compressors","optimalStartLockout","optimalStartDeviation","earliestStart","latestStart","heatPump","heatPumpBackup","heatPumpLockout","economizer","economizerSetpoint","coolingLockout"]})})]})]})}),(0,b.jsx)("h1",{children:"Units"}),(0,b.jsxs)("div",{className:"list",children:[null===l||void 0===l?void 0:l.map((function(e,n){var i,t;return e.id===(null===f||void 0===f?void 0:f.id)?(0,b.jsxs)(h.Zb,{interactive:!0,children:[(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{children:(0,b.jsx)(h.__,{children:(0,b.jsx)("h3",{children:e.label})})}),(0,b.jsxs)("div",{children:[a.renderStatus(e),(0,b.jsx)(W.u,{content:"Save",placement:u.Ly.TOP,disabled:!a.isSave(e),children:(0,b.jsx)(h.zx,{icon:x.$eC,intent:s.S.PRIMARY,minimal:!0,onClick:function(){return a.handleSave()},disabled:!a.isSave(e)})}),(0,b.jsx)(W.u,{content:"Exit",placement:u.Ly.TOP,children:(0,b.jsx)(h.zx,{icon:x.eV6,intent:s.S.PRIMARY,minimal:!0,onClick:function(){return a.handleCancel()}})})]})]}),(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:"Campus"}),(0,b.jsx)(h.BZ,{type:"text",value:e.campus,readOnly:!0})]})}),(0,b.jsx)("div",{children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:"Building"}),(0,b.jsx)(h.BZ,{type:"text",value:e.building,readOnly:!0})]})}),(0,b.jsx)("div",{children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:"System"}),(0,b.jsx)(h.BZ,{type:"text",value:e.system,readOnly:!0})]})}),(0,b.jsx)("div",{children:(0,b.jsxs)(h.__,{children:[(0,b.jsx)("b",{children:"Timezone"}),(0,b.jsx)(h.BZ,{type:"text",value:e.timezone,readOnly:!0})]})}),(0,b.jsx)("div",{})]}),(0,b.jsxs)(h.UO,{isOpen:!0,children:[!a.configRouteIsHidden&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.mp,{contents:[{id:"configuration",label:"Configuration",icon:x.$qo,hasCaret:!0,isExpanded:"configuration"===v}],onNodeExpand:function(e){return a.setState({expanded:e.id})},onNodeCollapse:function(){return a.setState({expanded:null})},onNodeClick:function(e){return a.setState({expanded:e.id===v?null:e.id})}}),(0,b.jsx)(h.UO,{isOpen:"configuration"===v,children:(0,b.jsx)(y,{unit:e,editing:f,configurations:d,handleChange:a.handleChange,handleCreate:a.handleCreate,readOnly:!a.isAdmin()})})]}),(0,b.jsx)(h.mp,{contents:[{id:"setpoints",label:"Setpoints",icon:x.IXo,hasCaret:!0,isExpanded:"setpoints"===v}],onNodeExpand:function(e){return a.setState({expanded:e.id})},onNodeCollapse:function(){return a.setState({expanded:null})},onNodeClick:function(e){return a.setState({expanded:e.id===v?null:e.id})}}),(0,b.jsx)(h.UO,{isOpen:"setpoints"===v,children:(0,b.jsx)(Q,{unit:e,editing:f,handleChange:a.handleChange})}),(0,b.jsx)(h.mp,{contents:[{id:"schedules",label:"Occupancy Schedules",icon:x.nfX,hasCaret:!0,isExpanded:"schedules"===v}],onNodeExpand:function(e){return a.setState({expanded:e.id})},onNodeCollapse:function(){return a.setState({expanded:null})},onNodeClick:function(e){return a.setState({expanded:e.id===v?null:e.id})}}),(0,b.jsx)(h.UO,{isOpen:"schedules"===v,children:(0,b.jsx)(K,{unit:e,editing:f,handleChange:a.handleChange,readOnly:!a.isAdmin()})}),(0,b.jsx)(h.mp,{contents:[{id:"holidays",label:"Holidays",icon:x.q4R,hasCaret:!0,isExpanded:"holidays"===v}],onNodeExpand:function(e){return a.setState({expanded:e.id})},onNodeCollapse:function(){return a.setState({expanded:null})},onNodeClick:function(e){return a.setState({expanded:e.id===v?null:e.id})}}),(0,b.jsx)(h.UO,{isOpen:"holidays"===v,children:(0,b.jsx)(A,{unit:e,editing:f,handleChange:a.handleChange,readOnly:!a.isAdmin()})}),(0,b.jsx)(h.mp,{contents:[{id:"occupancies",label:"Temporary Occupancy",icon:x.SdJ,hasCaret:!0,isExpanded:"occupancies"===v}],onNodeExpand:function(e){return a.setState({expanded:e.id})},onNodeCollapse:function(){return a.setState({expanded:null})},onNodeClick:function(e){return a.setState({expanded:e.id===v?null:e.id})}}),(0,b.jsx)(h.UO,{isOpen:"occupancies"===v,children:(0,b.jsx)(H,{unit:e,editing:f,handleChange:a.handleChange})}),(0,b.jsx)(h.mp,{contents:[{id:"rtu",label:"RTU Configuration",icon:x.lt1,hasCaret:!0,isExpanded:"rtu"===v}],onNodeExpand:function(e){return a.setState({expanded:e.id})},onNodeCollapse:function(){return a.setState({expanded:null})},onNodeClick:function(e){return a.setState({expanded:e.id===v?null:e.id})}}),(0,b.jsx)(h.UO,{isOpen:"rtu"===v,children:(0,b.jsx)(V.f,{unit:e,editing:f,handleChange:a.handleChange,hidden:a.isAdmin()?["peakLoadExclude","coolingPeakOffset","heatingPeakOffset","zoneLocation","zoneMass","zoneOrientation","zoneBuilding","coolingCapacity","compressors","heatPumpBackup"]:["location","peakLoadExclude","coolingPeakOffset","heatingPeakOffset","zoneLocation","zoneMass","zoneOrientation","zoneBuilding","coolingCapacity","compressors","optimalStartLockout","optimalStartDeviation","earliestStart","latestStart","heatPump","heatPumpBackup","heatPumpLockout","economizer","economizerSetpoint","coolingLockout"]})})]})]},null!==(i=e.id)&&void 0!==i?i:n):(0,b.jsx)(h.Zb,{interactive:!0,children:(0,b.jsxs)("div",{className:"row",children:[(0,b.jsx)("div",{children:(0,b.jsx)(h.__,{children:(0,b.jsx)("h3",{children:e.label})})}),(0,b.jsxs)("div",{children:[a.renderStatus(e),(0,b.jsx)(W.u,{content:"Edit",placement:u.Ly.TOP,children:(0,b.jsx)(h.zx,{icon:x.dme,intent:s.S.PRIMARY,minimal:!0,onClick:function(){return a.handleEdit(e)}})})]})]})},null!==(t=e.id)&&void 0!==t?t:n)})),this.renderConfirm()]})]})}}]),i}(j.Component),ae={readUnits:v.Vh,readUnitsPoll:v.j5,filterUnits:v.Oe,updateUnit:v.t1,readConfigurations:f.uu,readConfigurationsPoll:f.z2,createConfiguration:f.Gx,updateConfiguration:f.a3,deleteConfiguration:f.Xc,updateSetpoint:ee.d8},oe=(0,k.$j)((function(e){return{units:(0,v.OB)(e),filtered:(0,v.ey)(e),configurations:(0,f.yp)(e)}}),ae)(te),le=function(e){return(0,b.jsx)(a.Z,(0,t.Z)((0,t.Z)({},e),{},{renderRoute:function(e){return(0,b.jsx)(oe,(0,t.Z)({},e))}}))}},77848:function(e,n,i){i.d(n,{LK:function(){return r},ER:function(){return u},kI:function(){return s}});var t=i(49107),a=i(63769),o=i(696),l=i(72426),d=i.n(l),c=i(763),r=function(e){return d()().format("dddd, MMMM Do YYYY")},s=function(e){return 0===(0,c.sum)(Object.values((null===e||void 0===e?void 0:e._count)||{}))},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),n={label:"",setpoint:t.Qf,deadband:t.tz,heating:t.cF,cooling:t.tE};n.label=(0,t.hD)("all",n);var i={label:"",occupied:!0,startTime:(0,a.cz)(a.S$),endTime:(0,a.cz)(a.Be)};i.label=(0,a.sG)("all",i);var l={label:"",occupied:!1,startTime:(0,a.cz)(a.S$),endTime:(0,a.cz)(a.Be)};l.label=(0,a.sG)("all",l);var d=[o.R$.NewYearsDayType,o.R$.MartinLutherKingJrType,o.R$.PresidentsDayType,o.R$.MemorialDayType,o.R$.JuneteenthType,o.R$.IndependenceDayType,o.R$.LaborDayType,o.R$.ColumbusDayType,o.R$.VeteransDayType,o.R$.ThanksgivingType,o.R$.BlackFridayType,o.R$.ChristmasType].map((function(e){return e.name})),c=o.R$.values.map((function(e){return{label:e.label,type:d.includes(e.name)?"Enabled":"Disabled"}}));return{label:e,setpoint:n,mondaySchedule:i,tuesdaySchedule:i,wednesdaySchedule:i,thursdaySchedule:i,fridaySchedule:i,saturdaySchedule:l,sundaySchedule:l,holidaySchedule:l,holidays:c}}},63769:function(e,n,i){i.d(n,{Ls:function(){return l},lL:function(){return d},S$:function(){return c},QM:function(){return r},Be:function(){return s},cz:function(){return p},li:function(){return f},xM:function(){return v},sG:function(){return x}});var t=i(763),a=i(72426),o=i.n(a),l=120,d=0,c=480,r=1440,s=1080,u="HH:mm",h="h:mm\xa0a",p=function(e){return o()("00:00",[u]).add(Math.trunc(e/60),"hours").add(e%60,"minutes").format(u)},f=function(e){return o()("00:00",[u]).add(Math.trunc(e/60),"hours").add(e%60,"minutes").format(h)},v=function(e,n){return 60*function(e,n,i){return i&&0===e?n:e}(o()(e,[u,h]).hours(),24,n)+o()(e,[u,h]).minutes()},x=function(e,n){var i=void 0===(null===n||void 0===n?void 0:n.occupied)||n.occupied,a=(0,t.isNumber)(n.startTime)?n.startTime:v(n.startTime,!1),o=(0,t.isNumber)(n.endTime)?n.endTime:v(n.endTime,!0);switch(e){case"startTime":return"".concat(f(a));case"endTime":return"".concat(f(o));default:return i?0===a&&1440===o?"Occupied All Day":"Occupied From Start Time: ".concat(f(a)," To End Time: ").concat(f(o)):"Unoccupied All Day"}}},49107:function(e,n,i){i.d(n,{ax:function(){return p},bM:function(){return f},iz:function(){return v},tz:function(){return x},op:function(){return g},cF:function(){return m},Ig:function(){return j},tE:function(){return b},QG:function(){return y},Of:function(){return S},Qf:function(){return C},hD:function(){return N},qr:function(){return O},hQ:function(){return T}});var t,a,o,l,d,c,r,s,u=i(763),h=i(696),p=parseInt("2"),f=(null===(t=h.g9.DeadbandType.options)||void 0===t?void 0:t.min)||2,v=(null===(a=h.g9.DeadbandType.options)||void 0===a?void 0:a.max)||6,x=(null===(o=h.g9.DeadbandType.options)||void 0===o?void 0:o.default)||4,g=(null===(l=h.g9.HeatingType.options)||void 0===l?void 0:l.min)||55,m=(null===(d=h.g9.HeatingType.options)||void 0===d?void 0:d.default)||60,j=(null===(c=h.g9.CoolingType.options)||void 0===c?void 0:c.max)||85,b=(null===(r=h.g9.CoolingType.options)||void 0===r?void 0:r.default)||80,y=g,S=j,C=(null===(s=h.g9.SetpointType.options)||void 0===s?void 0:s.default)||70,N=function e(n,i){return"all"===n?"Occupied Setpoint: ".concat(e("setpoint",i)," Deadband: ").concat(e("deadband",i)," Unoccupied Heating: ").concat(e("heating",i)," Cooling: ").concat(e("cooling",i)):"".concat(i[n],"\xba\xa0F")},O=function(e){return e.deadband<f||e.deadband>v?"Deadband must be in the range [".concat(f,",").concat(v,"]."):e.setpoint<e.heating+p+e.deadband/2||e.setpoint>e.cooling-p-e.deadband/2?"Occupied setpoint must be in the range [".concat(e.heating+p+e.deadband/2,",").concat(e.cooling-p-e.deadband/2,"]"):e.heating<g||e.cooling>j?"Unoccupied heating and cooling must be in the range [".concat(g,",").concat(j,"]"):e.setpoint%.5!==0?"Occupied setpoint must be a whole or half degree.":e.deadband%1!==0?"Deadband must be a whole degree.":e.heating%.5!==0||e.cooling%.5!==0?"Unoccupied heating or cooling must be a whole or half degree.":void 0},T=function(e){return!!(e&&(0,u.isNumber)(e.setpoint)&&(0,u.isNumber)(e.deadband)&&(0,u.isNumber)(e.heating)&&(0,u.isNumber)(e.cooling))&&void 0===O(e)}}}]);
//# sourceMappingURL=957.547f659f.chunk.js.map
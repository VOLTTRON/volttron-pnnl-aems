"use strict";(self.webpackChunkaems_client=self.webpackChunkaems_client||[]).push([[715],{38715:function(e,n,t){t.r(n),t.d(n,{default:function(){return L}});var i=t(1413),a=t(93433),l=t(15671),o=t(43144),r=t(60136),s=t(43668),d=t(50698),c=t(32183),u=t(9418),h=t(36625),p=t(49259),v=t(23122),x=t(763),f=t(72791),m=t(696),j=t(95785),b=t(99574),C=t(53381),g=t(60364),S=t(24824),k=t(80184),y=function(e){(0,r.Z)(t,e);var n=(0,s.Z)(t);function t(e){var i;return(0,l.Z)(this,t),(i=n.call(this,e)).getValue=function(e,n,t){var a=i.props.controls,l=null!==t&&void 0!==t?t:null===a||void 0===a?void 0:a.find((function(e){return e.id===(null===n||void 0===n?void 0:n.id)}));return(0,x.get)(n,e,(0,x.get)(l,e))},i.handleChange=function(e,n){return function(t){n&&((0,x.isObject)(i.getValue(e,n))?(0,x.set)(n,e,(0,x.merge)((0,x.cloneDeep)((0,x.get)(n,e)),t)):(0,x.set)(n,e,t),i.setState({editing:n}))}},i.handleEdit=function(e){var n=i.props.filtered,t=i.state.editing,a=t&&(null===n||void 0===n?void 0:n.find((function(e){return e.id===t.id})));a&&i.isSave(a)?i.setState({confirm:function(){return i.setState({editing:{id:e.id,units:a.units.map((function(e){return{id:e.id}}))}})}}):i.setState({editing:{id:e.id,units:e.units.map((function(e){return{id:e.id}}))}})},i.handleCancel=function(){var e=i.props.filtered,n=i.state.editing,t=n&&(null===e||void 0===e?void 0:e.find((function(e){return e.id===n.id})));t&&i.isSave(t)?i.setState({confirm:function(){return i.setState({editing:null})}}):i.setState({editing:null})},i.handleConfirm=function(){var e=i.state.confirm;i.setState({confirm:null},null!==e&&void 0!==e?e:void 0)},i.handleSave=function(){var e=i.state.editing;e&&i.props.updateControl(e)},i.handlePush=function(e){var n=e.id;void 0!==n&&i.props.updateControl({id:n,stage:m.$b.UpdateType.label})},i.isSave=function(e){var n=i.state.editing,t=(0,x.merge)({},e,n);return!(0,x.isEqual)(e,t)},i.isPush=function(e){switch(e.stage){case m.$b.UpdateType.label:case m.$b.DeleteType.label:case m.$b.ProcessType.label:return!1;case m.$b.CreateType.label:case m.$b.CompleteType.label:case m.$b.FailType.label:default:return!i.isSave(e)}},i.state={editing:null,expanded:null,confirm:null},i}return(0,o.Z)(t,[{key:"componentDidMount",value:function(){this.props.readControls(),this.props.readControlsPoll(S.Jd)}},{key:"componentWillUnmount",value:function(){this.props.readControlsPoll()}},{key:"renderStatus",value:function(e){var n=this,t=v.WNC,i=d.S.WARNING;switch(e.stage){case m.$b.UpdateType.label:t=v.RGM,i=d.S.PRIMARY;break;case m.$b.ProcessType.label:t=v.RGM,i=d.S.SUCCESS;break;case m.$b.CreateType.label:t=v.WNC,i=d.S.WARNING;break;case m.$b.DeleteType.label:t=v.yY6,i=d.S.DANGER;break;case m.$b.CompleteType.label:t=v.ae_,i=d.S.SUCCESS;break;case m.$b.FailType.label:t=v.pnR,i=d.S.DANGER}if((0,x.get)(e,"peakLoadExclude",!1)&&(t=v.jSx,i=d.S.NONE),(0,x.has)(e,"units")){var a=e;return(0,k.jsx)(j.u,{content:"Push ILC Configuration",placement:c.Ly.TOP,children:(0,k.jsx)(u.zx,{icon:t,intent:i,minimal:!0,onClick:function(){return n.handlePush(a)},disabled:!this.isPush(a)})})}return(0,k.jsx)(u.zx,{icon:t,intent:i,minimal:!0})}},{key:"renderConfirm",value:function(){var e=this;return null===this.state.confirm?null:(0,k.jsx)(u.bZ,{intent:d.S.DANGER,isOpen:!0,confirmButtonText:"Yes",cancelButtonText:"Cancel",onConfirm:function(){return e.handleConfirm()},onClose:function(){return e.setState({confirm:null})},children:(0,k.jsx)("p",{children:"There are changes which have not been saved. Do you still want to continue?"})})}},{key:"renderPrompt",value:function(){var e=this.props.filtered,n=this.state.editing,t=n&&(null===e||void 0===e?void 0:e.find((function(e){return e.id===n.id}))),i=!(0,x.isNil)(t)&&this.isSave(t);return(0,k.jsx)(h.NL,{when:i,message:"There are changes which have not been saved. Do you still want to continue?"})}},{key:"render",value:function(){var e=this,n=this.props.filtered,t=this.state,l=t.editing,o=t.expanded;return(0,k.jsxs)("div",{className:"controls",children:[this.renderPrompt(),(0,k.jsx)(h.h4,(0,i.Z)({},this.props)),(0,k.jsx)("h1",{children:"Intelligent Load Control"}),(0,k.jsxs)("div",{className:"list",children:[null===n||void 0===n?void 0:n.map((function(n,t){var i,r,s;return n.id===(null===l||void 0===l?void 0:l.id)?(0,k.jsxs)(u.Zb,{interactive:!0,children:[(0,k.jsxs)("div",{className:"row",children:[(0,k.jsx)("div",{children:(0,k.jsx)(u.__,{children:(0,k.jsx)("h3",{children:n.label})})}),(0,k.jsxs)("div",{children:[e.renderStatus(n),(0,k.jsx)(j.u,{content:"Save",placement:c.Ly.TOP,disabled:!e.isSave(n),children:(0,k.jsx)(u.zx,{icon:v.$eC,intent:d.S.PRIMARY,minimal:!0,onClick:function(){return e.handleSave()},disabled:!e.isSave(n)})}),(0,k.jsx)(j.u,{content:"Exit",placement:c.Ly.TOP,children:(0,k.jsx)(u.zx,{icon:v.eV6,intent:d.S.PRIMARY,minimal:!0,onClick:function(){return e.handleCancel()}})})]})]}),(0,k.jsxs)("div",{className:"row",children:[(0,k.jsx)("div",{children:(0,k.jsxs)(u.__,{children:[(0,k.jsx)("b",{children:"Campus"}),(0,k.jsx)(u.BZ,{type:"text",value:n.campus,readOnly:!0})]})}),(0,k.jsx)("div",{children:(0,k.jsxs)(u.__,{children:[(0,k.jsx)("b",{children:"Building"}),(0,k.jsx)(u.BZ,{type:"text",value:n.building,readOnly:!0})]})}),(0,k.jsx)("div",{})]}),(0,k.jsxs)("div",{className:"row",children:[(0,k.jsx)("div",{className:"label",children:(0,k.jsxs)(u.__,{children:[(0,k.jsx)("b",{children:"ILC Label"}),(0,k.jsx)(u.BZ,{type:"text",value:e.getValue("label",l,n),onChange:function(n){return e.handleChange("label",l)(n.target.value)}})]})}),(0,k.jsx)("div",{})]}),(0,k.jsxs)("div",{className:"row",children:[(0,k.jsx)("div",{className:"select",children:(0,k.jsxs)(u.__,{children:[(0,k.jsx)("b",{children:"Participate in Grid Services"}),(0,k.jsx)(b.p,{content:(0,k.jsx)(u.v2,{children:null===(r=[{name:!1,label:"Yes"},{name:!0,label:"No"}])||void 0===r?void 0:r.map((function(n){return(0,k.jsx)(u.sN,{text:n.label,onClick:function(){return e.handleChange("peakLoadExclude",l)(n.name)}},n.label)}))}),placement:"bottom-start",children:(0,k.jsx)(u.zx,{rightIcon:v.vv6,minimal:!0,children:e.getValue("peakLoadExclude",l,n)?"No":"Yes"})})]})}),(0,k.jsx)("div",{}),(0,k.jsx)("div",{})]}),(0,k.jsx)(u.__,{children:(0,k.jsx)("h3",{children:"Units"})}),n.units.map((function(t,i){var r,s;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(u.mp,{contents:[{id:"unit-".concat(t.id),label:t.label,hasCaret:!0,isExpanded:o==="".concat(n.id,"-").concat(t.id)}],onNodeExpand:function(i){return e.setState({expanded:"".concat(n.id,"-").concat(t.id)})},onNodeCollapse:function(){return e.setState({expanded:null})},onNodeClick:function(i){return e.setState({expanded:"".concat(n.id,"-").concat(t.id)===o?null:"".concat(n.id,"-").concat(t.id)})}},"tree-".concat(t.id)),(0,k.jsx)(u.UO,{isOpen:o==="".concat(n.id,"-").concat(t.id),children:(0,k.jsx)(C.f,{unit:t,editing:null!==(r=null===l||void 0===l||null===(s=l.units)||void 0===s?void 0:s.find((function(e){return(null===e||void 0===e?void 0:e.id)===t.id})))&&void 0!==r?r:null,handleChange:function(n){return e.handleChange("units[".concat(i,"].").concat(n),l)},hidden:[].concat((0,a.Z)(e.getValue("peakLoadExclude",l,n)?["peakLoadExclude"]:[]),(0,a.Z)(e.getValue("peakLoadExclude",l,n)||e.getValue("units[".concat(i,"].peakLoadExclude"),l,n)?["zoneLocation","zoneMass","zoneOrientation","zoneBuilding","coolingCapacity","compressors","heatPump","heatPumpBackup","coolingPeakOffset","heatingPeakOffset"]:[]),["optimalStartLockout","optimalStartDeviation","earliestStart","latestStart","economizer","economizerSetpoint","heatPumpLockout","coolingLockout"])})},"collapse-".concat(t.id))]})}))]},"control-".concat(null!==(i=n.id)&&void 0!==i?i:t,"-editing")):(0,k.jsx)(u.Zb,{interactive:!0,children:(0,k.jsxs)("div",{className:"row",children:[(0,k.jsx)("div",{children:(0,k.jsx)(u.__,{children:(0,k.jsx)("h3",{children:n.label})})}),(0,k.jsxs)("div",{children:[e.renderStatus(n),(0,k.jsx)(j.u,{content:"Edit",placement:c.Ly.TOP,children:(0,k.jsx)(u.zx,{icon:v.dme,intent:d.S.PRIMARY,minimal:!0,onClick:function(){return e.handleEdit(n)}})})]})]})},"control-".concat(null!==(s=n.id)&&void 0!==s?s:t))})),this.renderConfirm()]})]})}}]),t}(f.Component),N={readControls:p.vH,readControlsPoll:p.TQ,filterControls:p.p_,updateControl:p.WL},P=(0,g.$j)((function(e){return{controls:(0,p.qQ)(e),filtered:(0,p.lw)(e)}}),N)(y),T=t(9153),L=function(e){return(0,k.jsx)(T.Z,(0,i.Z)((0,i.Z)({},e),{},{renderRoute:function(e){return(0,k.jsx)(P,(0,i.Z)({},e))}}))}}}]);
//# sourceMappingURL=715.ccfe51ac.chunk.js.map
"use strict";(self.webpackChunkaems_client=self.webpackChunkaems_client||[]).push([[237],{53381:function(e,n,i){i.d(n,{f:function(){return te}});var t,a,d,o,l,c,s,r,u,h,p,v,x,m,g,j,f,b,S,y,C,N,T=i(1413),O=i(4942),k=i(29439),Z=i(51976),z=i(696),R=(i(72426),i(763)),E=null===(t=z.g9.CoolingCapacityType.options)||void 0===t?void 0:t.min,_=null===(a=z.g9.CoolingCapacityType.options)||void 0===a?void 0:a.max,w=null===(d=z.g9.CompressorsType.options)||void 0===d?void 0:d.min,D=null===(o=z.g9.CompressorsType.options)||void 0===o?void 0:o.max,B=null===(l=z.g9.CoolingLockoutType.options)||void 0===l?void 0:l.min,P=null===(c=z.g9.CoolingLockoutType.options)||void 0===c?void 0:c.max,A=null===(s=z.g9.OptimalStartLockoutType.options)||void 0===s?void 0:s.min,L=null===(r=z.g9.OptimalStartLockoutType.options)||void 0===r?void 0:r.max,M=null===(u=z.g9.OptimalStartDeviationType.options)||void 0===u?void 0:u.min,U=null===(h=z.g9.OptimalStartDeviationType.options)||void 0===h?void 0:h.max,H=null===(p=z.g9.EarliestStartType.options)||void 0===p?void 0:p.min,Y=null===(v=z.g9.EarliestStartType.options)||void 0===v?void 0:v.max,I=null===(x=z.g9.LatestStartType.options)||void 0===x?void 0:x.min,$=null===(m=z.g9.LatestStartType.options)||void 0===m?void 0:m.max,K=null===(g=z.g9.HeatPumpBackupType.options)||void 0===g?void 0:g.min,F=null===(j=z.g9.HeatPumpBackupType.options)||void 0===j?void 0:j.max,q=null===(f=z.g9.HeatPumpLockoutType.options)||void 0===f?void 0:f.min,G=null===(b=z.g9.HeatPumpLockoutType.options)||void 0===b?void 0:b.max,V=null===(S=z.g9.SetpointPeakOffsetType.options)||void 0===S?void 0:S.min,W=null===(y=z.g9.SetpointPeakOffsetType.options)||void 0===y?void 0:y.max,X=null===(C=z.g9.EconomizerSetpoint.options)||void 0===C?void 0:C.min,J=null===(N=z.g9.EconomizerSetpoint.options)||void 0===N?void 0:N.max,Q=i(72791),ee=i(23122),ne=i(99574),ie=i(80184);function te(e){var n=e.hidden,i=e.unit,t=e.editing,a=e.handleChange,d=(0,Q.useState)({}),o=(0,k.Z)(d,2),l=o[0],c=o[1],s=(0,Q.useCallback)((function(e){return(0,R.get)(t,e,(0,R.get)(i,e))}),[t,i]),r=function(e,n,i,d,o,r,u){var h=l[o];return void 0===h&&(h=s(o)),(0,ie.jsxs)(Z.__,{children:[(0,ie.jsx)("b",{children:n}),(0,ie.jsx)(Z.Af,(0,T.Z)((0,T.Z)((0,T.Z)({},e),{},{step:1},u&&{minorStepSize:1e-4}),{},{min:i,max:d,value:h,onValueChange:function(e,n){u&&c((0,R.merge)({},l,(0,O.Z)({},o,n))),a(o,t)(e)},rightElement:r,clampValueOnBlur:!0}))]})},u=function(e,n,i,d,o,l){return(0,ie.jsxs)(Z.__,{children:[(0,ie.jsx)("b",{children:n}),(0,ie.jsx)(Z.Zz,(0,T.Z)((0,T.Z)({},e),{},{min:i,max:d,stepSize:.5,labelStepSize:o,labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>i&&e<d?"".concat(e,"\xba\xa0F"):""},children:(0,ie.jsx)(Z.Zz.Handle,{type:Z.gZ.FULL,interactionKind:Z.qB.LOCK,value:s(l),onChange:function(e){a(l,t)(e)}})}))]})},h=function(e,n,i,d,o,l){return(0,ie.jsxs)(Z.__,{children:[(0,ie.jsx)("b",{children:n}),(0,ie.jsx)(Z.Zz,(0,T.Z)((0,T.Z)({},e),{},{min:i,max:d,stepSize:5,labelStepSize:o,labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>i&&e<d?"".concat(e,"\xa0min"):""},children:(0,ie.jsx)(Z.Zz.Handle,{type:Z.gZ.FULL,interactionKind:Z.qB.LOCK,value:s(l),onChange:function(e){a(l,t)(e)}})}))]})},p=function(e,n,i,d,o){return(0,ie.jsxs)(Z.__,{children:[(0,ie.jsx)("b",{children:n}),(0,ie.jsx)(ne.p,{content:(0,ie.jsx)(Z.v2,{children:null===i||void 0===i?void 0:i.map((function(e){return(0,ie.jsx)(Z.sN,{text:e.label,onClick:function(){return a(d,t)(e.name)}},e.label)}))}),placement:"bottom-start",children:(0,ie.jsx)(Z.zx,(0,T.Z)((0,T.Z)({},e),{},{rightIcon:ee.vv6,minimal:!0,children:o?o(s(d)):s(d)}))})]})};return(0,ie.jsxs)(ie.Fragment,{children:[(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("label"),children:[(0,ie.jsx)("h3",{children:" "}),(0,ie.jsx)("div",{className:"unit",children:(0,ie.jsxs)(Z.__,{children:[(0,ie.jsx)("b",{children:"Unit Label"}),(0,ie.jsx)(Z.BZ,{type:"text",value:s("label"),onChange:function(e){a("label",t)(e.target.value)}})]})}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("peakLoadExclude"),children:[(0,ie.jsx)("div",{className:"select",children:p({},"Participate in Grid Services",[{name:!1,label:"Yes"},{name:!0,label:"No"}],"peakLoadExclude",(function(e){return e?"No":"Yes"}))}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("setpointPeakOffset"),children:[(0,ie.jsx)("div",{className:"unit",children:u(s("peakLoadExclude")?{disabled:!0}:{},"Setpoint Offset During Grid Services",V,W,1,"setpointPeakOffset")}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("zoneLocation"),children:[(0,ie.jsx)("div",{className:"select",children:p({},"Zone Location",z.Ak.values.filter((function(e){return"location"===e.type})),"zoneLocation",(function(e){var n;return(null===(n=z.Ak.parse(e))||void 0===n?void 0:n.label)||e}))}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("zoneMass"),children:[(0,ie.jsx)("div",{className:"select",children:p({},"Zone Mass",z.Ak.values.filter((function(e){return"mass"===e.type})),"zoneMass",(function(e){var n;return(null===(n=z.Ak.parse(e))||void 0===n?void 0:n.label)||e}))}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("zoneOrientation"),children:[(0,ie.jsx)("div",{className:"select",children:p({},"Zone Orientation",z.Ak.values.filter((function(e){return"orientation"===e.type})),"zoneOrientation",(function(e){var n;return(null===(n=z.Ak.parse(e))||void 0===n?void 0:n.label)||e}))}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("zoneBuilding"),children:[(0,ie.jsx)("div",{className:"select",children:p({},"Zone Type",z.Ak.values.filter((function(e){return"building"===e.type})),"zoneBuilding",(function(e){var n;return(null===(n=z.Ak.parse(e))||void 0===n?void 0:n.label)||e}))}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("coolingCapacity"),children:[(0,ie.jsx)("div",{className:"unit",children:r({},"Rated Cooling Capacity",E,_,"coolingCapacity",(0,ie.jsx)(Z.Vp,{minimal:!0,children:"tons"}))}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("compressors"),children:[(0,ie.jsx)("div",{className:"unit",children:r({},"Number of Compressors",w,D,"compressors")}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("optimalStartLockout"),children:[(0,ie.jsx)("div",{className:"unit",children:u({},"Disable Optimal Start when Outdoor Temperatures are below",A,L,2,"optimalStartLockout")}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("optimalStartDeviation"),children:[(0,ie.jsx)("div",{className:"unit",children:u({},"Optimal Start Allowable Zone Temperature Deviation",M,U,.5,"optimalStartDeviation")}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("earliestStart"),children:[(0,ie.jsx)("div",{className:"unit",children:h({},"Earliest Start Time Before Occupancy",H,Y,30,"earliestStart")}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("latestStart"),children:[(0,ie.jsx)("div",{className:"unit",children:h({},"Latest Start Time Before Occupancy",I,$,15,"latestStart")}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("heatPump"),children:[(0,ie.jsx)("div",{className:"select",children:p({},"Heat Pump",[{name:!0,label:"Yes"},{name:!1,label:"No"}],"heatPump",(function(e){return e?"Yes":"No"}))}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("heatPumpBackup"),children:[(0,ie.jsx)("div",{className:"unit",children:r(s("heatPump")?{}:{disabled:!0},"Heat Pump Electric Backup Capacity",K,F,"heatPumpBackup",(0,ie.jsx)(Z.Vp,{minimal:!0,children:"kW"}),!0)}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("heatPumpLockout"),children:[(0,ie.jsx)("div",{className:"unit",children:u(s("heatPump")?{}:{disabled:!0},"Heat Pump Auxiliary Heat Lockout",q,G,5,"heatPumpLockout")}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("economizer"),children:[(0,ie.jsx)("div",{className:"select",children:p({},"Economizer",[{name:!0,label:"Yes"},{name:!1,label:"No"}],"economizer",(function(e){return e?"Yes":"No"}))}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("economizerSetpoint"),children:[(0,ie.jsx)("div",{className:"unit",children:u(s("economizer")?{}:{disabled:!0},"Economizer Switchover Temperature Setpoint",X,J,5,"economizerSetpoint")}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]}),(0,ie.jsxs)("div",{className:"row",hidden:null===n||void 0===n?void 0:n.includes("coolingLockout"),children:[(0,ie.jsx)("div",{className:"unit",children:u(s("economizer")?{}:{disabled:!0},"Compressor Cooling Lockout Temperature",B,P,5,"coolingLockout")}),(0,ie.jsx)("div",{}),(0,ie.jsx)("div",{})]})]})}},37237:function(e,n,i){i.r(n),i.d(n,{default:function(){return ze}});var t=i(1413),a=i(9153),d=i(15671),o=i(43144),l=i(60136),c=i(43668),s=i(50698),r=i(32183),u=i(51976),h=i(36625),p=i(4481),v=i(97626),x=i(23122),m=i(763),g=i(99574),j=i(72791),f=i(80184);function b(e){var n,i=e.unit,t=e.editing,a=e.configurations,d=e.handleChange,o=e.handleCreate,l=(0,j.useCallback)((function(e){return(0,m.get)(t,e,(0,m.get)(i,e))}),[t,i]);return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{className:"configuration select",children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("h3",{children:"Select Configuration"}),(0,f.jsx)(g.p,{content:(0,f.jsxs)(u.v2,{children:[(0,f.jsx)(u.sN,{text:"New Configuration",onClick:function(){return o(i)}}),null===a||void 0===a?void 0:a.map((function(e){return(0,f.jsx)(u.sN,{text:e.label,onClick:function(){return d("configurationId",i)(e.id)}},e.id)}))]}),placement:"bottom-start",children:(0,f.jsx)(u.zx,{rightIcon:x.vv6,minimal:!0,children:(null===i||void 0===i||null===(n=i.configuration)||void 0===n?void 0:n.label)||"Select Configuration..."})})]})}),(0,f.jsx)("div",{})]}),(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{className:"label",children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:"Configuration Label"}),(0,f.jsx)(u.BZ,{type:"text",value:l("configuration.label"),onChange:function(e){return d("configuration.label",t)(e.target.value)}})]})}),(0,f.jsx)("div",{})]})]})}var S=i(29439),y=i(696),C=i(78719),N=i(42632),T=i(72426),O=i.n(T);function k(e){var n,i=e.path,t=e.unit,a=e.editing,d=e.holiday,o=e.handleChange,l=d.id,c=d.label,r=d.type,h=d.month,p=d.day,v=d.observance,g=(0,j.useCallback)((function(e){return(0,m.get)(a,e,(0,m.get)(t,e))}),[a,t]);if("Custom"===r){var b=v&&(null===(n=y.VD.parse(v))||void 0===n?void 0:n.label),S="".concat(O()().set("month",h-1).set("date",p).format("MMMM Do")," ").concat(b&&"(".concat(b,")"));return(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:c}),(0,f.jsx)(u.BZ,{type:"text",value:S,readOnly:!0})]})}),(0,f.jsx)("div",{children:(0,f.jsx)(u.zx,{icon:x.R4W,intent:s.S.WARNING,minimal:!0,onClick:function(){o(i,a)({id:l,type:r,action:"delete"})}})})]})})}return(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{className:"holiday",children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:c}),(0,f.jsx)(u.XZ,{label:"Enabled",checked:"Enabled"===g("".concat(i,".type")),onClick:function(){o("".concat(i),a)({id:g("".concat(i,".id")),type:"Enabled"===g("".concat(i,".type"))?"Disabled":"Enabled"})}})]})}),(0,f.jsx)("div",{})]})}var Z=i(60364),z=y.R$.values.map((function(e){return e.label}));function R(e){var n=e.unit,i=e.editing,t=e.handleChange,a=e.holidays,d=(0,j.useState)(""),o=(0,S.Z)(d,2),l=o[0],c=o[1],r=(0,j.useState)(new Date),h=(0,S.Z)(r,2),p=h[0],v=h[1],b=(0,j.useState)(""),C=(0,S.Z)(b,2),T=C[0],k=C[1],Z=(0,j.useState)(!1),z=(0,S.Z)(Z,2),R=z[0],E=z[1];return(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{className:"label",children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:"Holiday Label"}),(0,f.jsx)(u.BZ,{type:"text",value:l,onChange:function(e){return c(e.target.value)}})]})}),(0,f.jsx)("div",{children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:"Date"}),(0,f.jsx)(g.p,{content:(0,f.jsx)(N.M,{value:p,onChange:function(e,n){e&&v(e),E(!n)}}),isOpen:R,placement:"bottom-start",children:(0,f.jsx)(u.zx,{rightIcon:x.XNV,onClick:function(){return E(!0)},minimal:!0,children:O()(p).format("MMMM Do")})})]})}),(0,f.jsx)("div",{children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:"Observance"}),(0,f.jsx)(g.p,{content:(0,f.jsxs)(u.v2,{children:[(0,f.jsx)(u.sN,{text:"Always on Date",onClick:function(){return k("")}}),y.VD.values.map((function(e){return(0,f.jsx)(u.sN,{text:e.label,onClick:function(){return k(e.label)}},e.name)}))]}),placement:"bottom-start",children:(0,f.jsx)(u.zx,{rightIcon:x.vv6,minimal:!0,children:T||"Always on Date"})})]})}),(0,f.jsx)("div",{children:(0,f.jsx)(u.zx,{icon:x.YZ9,intent:s.S.PRIMARY,minimal:!0,disabled:(0,m.isEmpty)(l)||void 0!==a.find((function(e){return e.label===l})),onClick:function(){var e,a=Math.max((0,m.get)(n,"configuration.holidays.length",0),(0,m.get)(i,"configuration.holidays.length",0));t("configuration.holidays.".concat(a),i)({type:"Custom",label:l,month:p.getMonth()+1,day:p.getDate(),observance:T,configurationId:null===n||void 0===n||null===(e=n.configuration)||void 0===e?void 0:e.id,createdAt:O()().format(),action:"create"}),c(""),v(new Date),k("")},children:"Create Holiday"})})]})}function E(e){var n,i=e.unit,t=e.editing,a=e.handleChange,d=(0,Z.I0)(),o=(0,j.useState)(void 0),l=(0,S.Z)(o,2),c=l[0],r=l[1],h=(0,m.merge)([],null===(n=i.configuration)||void 0===n?void 0:n.holidays,(0,m.get)(t,"configuration.holidays"));return h.forEach((function(e,n){return e.index=n})),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(u.__,{children:[(0,f.jsx)("h3",{children:"Create Holiday"}),(0,f.jsx)(R,{unit:i,editing:t,handleChange:a,holidays:h})]}),(0,f.jsxs)(u.__,{children:[(0,f.jsx)("h3",{children:"Custom Holidays"}),(0,f.jsx)("ul",{children:(0,m.isEmpty)(h.filter((function(e){return"Custom"===e.type&&"delete"!==e.action})))?(0,f.jsx)("li",{children:"No Custom Holidays Defined"},"empty"):h.filter((function(e){return"Custom"===e.type&&"delete"!==e.action})).sort((function(e,n){return O()(n.createdAt).valueOf()-O()(e.createdAt).valueOf()})).map((function(e,n){return(0,f.jsx)("li",{children:(0,f.jsx)(k,{path:"configuration.holidays.".concat(e.index),unit:i,editing:t,holiday:e,handleChange:a},e.index)},e.index)}))})]}),(0,f.jsxs)(u.__,{children:[(0,f.jsx)("h3",{children:"Predefined Holidays"}),(0,f.jsx)("ul",{children:h.filter((function(e){return"Custom"!==e.type})).sort((function(e,n){return z.indexOf(e.label)-z.indexOf(n.label)})).map((function(e,n){return(0,f.jsx)("li",{children:(0,f.jsx)(k,{path:"configuration.holidays.".concat(e.index),unit:i,editing:t,holiday:e,handleChange:a},e.index)},e.index)}))})]}),(0,f.jsx)(u.bZ,{intent:s.S.DANGER,isOpen:void 0!==c,confirmButtonText:"Yes",cancelButtonText:"Cancel",onConfirm:function(){var e;return d((0,C.qd)(null!==(e=null===c||void 0===c?void 0:c.id)&&void 0!==e?e:-1))},onClose:function(){return r(void 0)},children:(0,f.jsxs)("p",{children:["Permanently delete the holiday ",null===c||void 0===c?void 0:c.label,"?"]})})]})}var _=120,w=480,D=1440,B=1080,P="HH:mm",A="h:mm\xa0a",L=function(e){return O()("00:00",[P]).add(Math.trunc(e/60),"hours").add(e%60,"minutes").format(P)},M=function(e){return O()("00:00",[P]).add(Math.trunc(e/60),"hours").add(e%60,"minutes").format(A)},U=function(e,n){return 60*function(e,n,i){return i&&0===e?n:e}(O()(e,[P,A]).hours(),24,n)+O()(e,[P,A]).minutes()},H=function(e,n){var i=void 0===(null===n||void 0===n?void 0:n.occupied)||n.occupied,t=(0,m.isNumber)(n.startTime)?n.startTime:U(n.startTime,!1),a=(0,m.isNumber)(n.endTime)?n.endTime:U(n.endTime,!0);switch(e){case"startTime":return"".concat(M(t));case"endTime":return"".concat(M(a));default:return i?0===t&&1440===a?"Occupied All Day":"Occupied From Start Time: ".concat(M(t)," To End Time: ").concat(M(a)):"Unoccupied All Day"}},Y=i(48565);function I(e){var n=e.path,i=e.editing,t=e.occupancy,a=e.handleChange,d=t.id,o=t.label,l=t.date,c=t.schedule,r=null===c||void 0===c?void 0:c.label,h="".concat(O()(l).format("dddd MMMM Do YYYY")," ").concat(r&&"(".concat(r,")")),p=O()(l).startOf("day").isBefore(O()().startOf("day"),"day");return(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{children:(0,f.jsxs)(u.__,{disabled:p,children:[(0,f.jsx)("b",{children:o}),(0,f.jsx)(u.BZ,{type:"text",value:h,disabled:p,readOnly:!0})]})}),(0,f.jsx)("div",{children:(0,f.jsx)(u.zx,{icon:x.R4W,intent:s.S.WARNING,minimal:!0,onClick:function(){a(n,i)({id:d,action:"delete"})}})})]})})}var $,K=i(50668),F=(0,K.parseBoolean)("false"),q={label:"",occupied:!0,startTime:L(w),endTime:L(B)};function G(e){var n=e.unit,i=e.editing,t=e.handleChange,a=(0,j.useState)(""),d=(0,S.Z)(a,2),o=d[0],l=d[1],c=(0,j.useState)(new Date),r=(0,S.Z)(c,2),h=r[0],p=r[1],v=(0,j.useState)((0,m.clone)(q)),b=(0,S.Z)(v,2),y=b[0],C=b[1],T=(0,j.useState)(!1),k=(0,S.Z)(T,2),Z=k[0],z=k[1],R=(0,j.useCallback)((function(e){return(0,m.get)(i,e,(0,m.get)(n,e))}),[i,n]),E=O()(h).format("dddd").toLowerCase(),w={schedule:{start:y.occupied?U(y.startTime,!1):0,end:y.occupied?U(y.endTime,!0):D},previous:{start:R("configuration.".concat(E,"Schedule.occupied"))?U(R("configuration.".concat(E,"Schedule.startTime")),!1):0,end:R("configuration.".concat(E,"Schedule.occupied"))?U(R("configuration.".concat(E,"Schedule.endTime")),!0):D,occupied:R("configuration.".concat(E,"Schedule.occupied"))}};return(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{className:"label",children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:"Occupancy Label"}),(0,f.jsx)(u.BZ,{type:"text",value:o,onChange:function(e){return l(e.target.value)}})]})}),(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{className:"label",children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:"Occupancy Schedule"}),(0,f.jsx)(u.BZ,{type:"text",value:y.label,readOnly:!0})]})}),(0,f.jsx)("div",{className:"occupancy",children:(0,f.jsxs)(u.Zz,{min:0,max:D,stepSize:5,labelStepSize:240,labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>0&&e<D?M(e):""},disabled:!y.occupied,children:[(0,f.jsx)(u.Zz.Handle,{type:u.gZ.START,interactionKind:u.qB.LOCK,intentAfter:y.occupied?s.S.SUCCESS:s.S.NONE,value:w.schedule.start,onChange:function(e){var n=(0,m.cloneDeep)(y),i=y.occupied,t=U(y.endTime,!0),a=(0,m.clamp)(e,0,Math.min(t,D)-_),d=H("all",{occupied:i,startTime:a,endTime:t});(0,m.merge)(n,{startTime:L(a),label:d}),C(n)}}),(0,f.jsx)(u.Zz.Handle,{type:u.gZ.START,interactionKind:u.qB.NONE,intentAfter:w.previous.occupied?(0,m.inRange)(w.previous.start,w.schedule.start,w.schedule.end)?s.S.SUCCESS:s.S.PRIMARY:s.S.NONE,value:w.previous.start}),(0,f.jsx)(u.Zz.Handle,{type:u.gZ.END,interactionKind:u.qB.NONE,intentBefore:w.previous.occupied?(0,m.inRange)(w.previous.end,w.schedule.start,w.schedule.end)?s.S.SUCCESS:s.S.PRIMARY:s.S.NONE,value:w.previous.end}),(0,f.jsx)(u.Zz.Handle,{type:u.gZ.END,interactionKind:u.qB.LOCK,intentBefore:y.occupied?s.S.SUCCESS:s.S.NONE,value:w.schedule.end,onChange:function(e){var n=(0,m.cloneDeep)(y),i=y.occupied,t=U(y.startTime,!1),a=(0,m.clamp)(e,Math.max(t,0)+_,D),d=H("all",{occupied:i,startTime:t,endTime:a});(0,m.merge)(n,{endTime:L(a),label:d}),C(n)}})]})}),F?(0,f.jsx)("div",{className:"unoccupied",children:(0,f.jsx)(u.XZ,{label:"Unoccupied",checked:!y.occupied,onClick:function(){var e=(0,m.cloneDeep)(y),n=!y.occupied,i=U(y.startTime,!1),t=U(y.endTime,!0),a=H("all",{occupied:n,startTime:i,endTime:t});(0,m.merge)(e,{occupied:n,label:a}),C(e)}})}):(0,f.jsx)("div",{})]}),(0,f.jsx)("div",{children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:"Date"}),(0,f.jsx)(g.p,{content:(0,f.jsx)(N.M,{value:h,onChange:function(e,n){e&&p(e),z(!n)}}),isOpen:Z,placement:"bottom-start",children:(0,f.jsx)(u.zx,{rightIcon:x.XNV,onClick:function(){return z(!0)},minimal:!0,children:O()(h).format("dddd MMMM Do YYYY")})})]})}),(0,f.jsx)("div",{children:(0,f.jsx)(u.zx,{icon:x.YZ9,intent:s.S.PRIMARY,minimal:!0,onClick:function(){var e,a=Math.max((0,m.get)(n,"configuration.occupancies.length",0),(0,m.get)(i,"configuration.occupancies.length",0));t("configuration.occupancies.".concat(a),i)({label:o,date:h.toISOString(),schedule:y,configurationId:null===n||void 0===n||null===(e=n.configuration)||void 0===e?void 0:e.id,createdAt:O()().format(),action:"create"}),l(""),p(new Date),C((0,m.clone)(q))},children:"Create Occupancy"})})]})}function V(e){var n,i=e.unit,t=e.editing,a=e.handleChange,d=(0,Z.I0)(),o=(0,j.useState)(void 0),l=(0,S.Z)(o,2),c=l[0],r=l[1],h=(0,m.merge)([],null===(n=i.configuration)||void 0===n?void 0:n.occupancies,(0,m.get)(t,"configuration.occupancies"));return h.forEach((function(e,n){return e.index=n})),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(u.__,{children:[(0,f.jsx)("h3",{children:"Create Occupancy"}),(0,f.jsx)(G,{unit:i,editing:t,handleChange:a})]}),(0,f.jsxs)(u.__,{children:[(0,f.jsx)("h3",{children:"Temporary Occupancies"}),(0,f.jsx)("ul",{children:(0,m.isEmpty)(h.filter((function(e){return"delete"!==e.action})))?(0,f.jsx)("li",{children:"No Temporary Occupancies Defined"},"empty"):h.filter((function(e){return"delete"!==e.action})).sort((function(e,n){return O()(n.date).valueOf()-O()(e.date).valueOf()})).map((function(e,n){return(0,f.jsx)("li",{children:(0,f.jsx)(I,{path:"configuration.occupancies.".concat(e.index),unit:i,editing:t,occupancy:e,handleChange:a},e.index)},e.index)}))})]}),(0,f.jsx)(u.bZ,{intent:s.S.DANGER,isOpen:void 0!==c,confirmButtonText:"Yes",cancelButtonText:"Cancel",onConfirm:function(){var e;return d((0,Y.VT)(null!==(e=null===c||void 0===c?void 0:c.id)&&void 0!==e?e:-1))},onClose:function(){return r(void 0)},children:(0,f.jsxs)("p",{children:["Permanently delete the occupancy ",null===c||void 0===c?void 0:c.label,"?"]})})]})}function W(e){var n=e.title,i=e.path,t=e.unit,a=e.editing,d=e.handleChange,o=e.readOnly,l=void 0===o?["title"]:o,c=(0,j.useCallback)((function(e){return(0,m.get)(a,e,(0,m.get)(t,e))}),[a,t]);return(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("h3",{children:" "}),(0,f.jsx)("div",{className:"label",children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:n}),(0,f.jsx)(u.BZ,{type:"text",value:c("".concat(i,".label")),onChange:function(e){d("".concat(i,".label"),a)(e.target.value)},readOnly:null===l||void 0===l?void 0:l.includes("title")})]})}),(0,f.jsx)("div",{className:"schedule",children:(0,f.jsx)(u.U2,{min:0,max:D,stepSize:5,labelStepSize:240,intent:s.S.SUCCESS,value:c("".concat(i,".occupied"))?[U(c("".concat(i,".startTime")),!1),U(c("".concat(i,".endTime")),!0)]:[0,0],labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>0&&e<D?M(e):""},disabled:!(0,m.get)(a,"".concat(i,".occupied"),(0,m.get)(t,"".concat(i,".occupied"))),onChange:function(e){var n=c("".concat(i,".occupied")),t=(0,m.clamp)(e[0],0,Math.min(e[1],D)-_),o=(0,m.clamp)(e[1],Math.max(e[0],0)+_,D),l=H("all",{occupied:n,startTime:t,endTime:o});d("".concat(i),a)({startTime:L(t),endTime:L(o),label:l})}})}),(0,f.jsx)("div",{className:"unoccupied",children:(0,f.jsx)(u.XZ,{label:"Unoccupied",checked:!c("".concat(i,".occupied")),onClick:function(){var e=!c("".concat(i,".occupied")),n=U(c("".concat(i,".startTime")),!1),t=U(c("".concat(i,".endTime")),!0),o=H("all",{occupied:e,startTime:n,endTime:t});d("".concat(i),a)({occupied:e,label:o})}})})]})}q.label=H("all",q);var X,J,Q,ee,ne,ie,te,ae,de=(0,K.parseBoolean)(null!==($="false")?$:"");function oe(e){var n=e.unit,i=e.editing,t=e.handleChange;return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(W,{title:"Monday Schedule",path:"configuration.mondaySchedule",unit:n,editing:i,handleChange:t}),(0,f.jsx)(W,{title:"Tuesday Schedule",path:"configuration.tuesdaySchedule",unit:n,editing:i,handleChange:t}),(0,f.jsx)(W,{title:"Wednesday Schedule",path:"configuration.wednesdaySchedule",unit:n,editing:i,handleChange:t}),(0,f.jsx)(W,{title:"Thursday Schedule",path:"configuration.thursdaySchedule",unit:n,editing:i,handleChange:t}),(0,f.jsx)(W,{title:"Friday Schedule",path:"configuration.fridaySchedule",unit:n,editing:i,handleChange:t}),(0,f.jsx)(W,{title:"Saturday Schedule",path:"configuration.saturdaySchedule",unit:n,editing:i,handleChange:t}),(0,f.jsx)(W,{title:"Sunday Schedule",path:"configuration.sundaySchedule",unit:n,editing:i,handleChange:t}),de&&(0,f.jsx)(W,{title:"Holiday Schedule",path:"configuration.holidaySchedule",unit:n,editing:i,handleChange:t})]})}var le=parseInt("2"),ce=(null===(X=y.g9.DeadbandType.options)||void 0===X?void 0:X.min)||2,se=(null===(J=y.g9.DeadbandType.options)||void 0===J?void 0:J.max)||6,re=(null===(Q=y.g9.DeadbandType.options)||void 0===Q?void 0:Q.default)||4,ue=(null===(ee=y.g9.HeatingType.options)||void 0===ee?void 0:ee.min)||55,he=(null===(ne=y.g9.HeatingType.options)||void 0===ne?void 0:ne.default)||60,pe=(null===(ie=y.g9.CoolingType.options)||void 0===ie?void 0:ie.max)||85,ve=(null===(te=y.g9.CoolingType.options)||void 0===te?void 0:te.default)||80,xe=ue,me=pe,ge=(null===(ae=y.g9.SetpointType.options)||void 0===ae?void 0:ae.default)||70,je=function e(n,i){return"all"===n?"Occupied Setpoint: ".concat(e("setpoint",i)," Deadband: ").concat(e("deadband",i)," Unoccupied Heating: ").concat(e("heating",i)," Cooling: ").concat(e("cooling",i)):"".concat(i[n],"\xba\xa0F")},fe=function(e){return e.deadband<ce||e.deadband>se?"Deadband must be in the range [".concat(ce,",").concat(se,"]."):e.setpoint<e.heating+le+e.deadband/2||e.setpoint>e.cooling-le-e.deadband/2?"Occupied setpoint must be in the range [".concat(e.heating+le+e.deadband/2,",").concat(e.cooling-le-e.deadband/2,"]"):e.heating<ue||e.cooling>pe?"Unoccupied heating and cooling must be in the range [".concat(ue,",").concat(pe,"]"):e.setpoint%.5!==0?"Occupied setpoint must be a whole or half degree.":e.deadband%1!==0?"Deadband must be a whole degree.":e.heating%.5!==0||e.cooling%.5!==0?"Unoccupied heating or cooling must be a whole or half degree.":void 0};function be(e){var n=e.type,i=e.title,t=e.path,a=e.unit,d=e.editing,o=e.setpoint,l=e.handleChange,c=e.readOnly,r=void 0===c?["title"]:c,h=(0,j.useCallback)((function(e){return(0,m.get)(d,e,(0,m.get)(a,e))}),[d,a]),p=(0,j.useMemo)((function(){return fe((0,m.merge)({},(0,m.get)(a,t),o))||"\xa0"}),[t,a,o]),v=function(){return(0,f.jsxs)(u.Zz,{min:xe,max:me,stepSize:.5,labelStepSize:5,labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>ue&&e<pe?"".concat(e,"\xba\xa0F"):""},children:[(0,f.jsx)(u.Zz.Handle,{type:u.gZ.START,interactionKind:u.qB.LOCK,intentAfter:s.S.WARNING,value:h("".concat(t,".heating")),onChange:function(e){var n=h("".concat(t,".setpoint")),i=h("".concat(t,".deadband")),a=le+i/2,o=(0,m.clamp)(e,ue,n-a),c=h("".concat(t,".cooling")),s=je("all",{setpoint:n,deadband:i,heating:o,cooling:c});l("".concat(t),d)({heating:o,label:s})}}),(0,f.jsx)(u.Zz.Handle,{type:u.gZ.START,interactionKind:u.qB.LOCK,intentAfter:s.S.NONE,value:h("".concat(t,".setpoint"))-h("".concat(t,".deadband"))/2,onChange:function(e){var n=h("".concat(t,".deadband")),i=le+n/2,a=h("".concat(t,".heating")),o=h("".concat(t,".cooling")),c=e+n/2,s=(0,m.clamp)(c,a+i,o-i),r=je("all",{setpoint:s,deadband:n,heating:a,cooling:o});l("".concat(t),d)({setpoint:s,label:r})}}),(0,f.jsx)(u.Zz.Handle,{type:u.gZ.END,interactionKind:u.qB.LOCK,intentBefore:s.S.NONE,value:h("".concat(t,".setpoint"))+h("".concat(t,".deadband"))/2,onChange:function(e){var n=h("".concat(t,".deadband")),i=le+n/2,a=h("".concat(t,".heating")),o=h("".concat(t,".cooling")),c=e-n/2,s=(0,m.clamp)(c,a+i,o-i),r=je("all",{setpoint:s,deadband:n,heating:a,cooling:o});l("".concat(t),d)({setpoint:s,label:r})}}),(0,f.jsx)(u.Zz.Handle,{type:u.gZ.END,interactionKind:u.qB.LOCK,intentBefore:s.S.PRIMARY,value:h("".concat(t,".cooling")),onChange:function(e){var n=h("".concat(t,".setpoint")),i=h("".concat(t,".deadband")),a=le+i/2,o=h("".concat(t,".heating")),c=(0,m.clamp)(e,n+a,pe),s=je("all",{setpoint:n,deadband:i,heating:o,cooling:c});l("".concat(t),d)({cooling:c,label:s})}})]})},x=function(){return(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:"Occupied"}),(0,f.jsxs)(u.Zz,{min:xe,max:me,stepSize:.5,labelStepSize:5,intent:s.S.SUCCESS,labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>ue&&e<pe?"".concat(e,"\xba\xa0F"):""},children:[(0,f.jsx)(u.Zz.Handle,{type:u.gZ.START,interactionKind:u.qB.LOCK,intentBefore:s.S.WARNING,intentAfter:s.S.SUCCESS,value:h("".concat(t,".setpoint"))-h("".concat(t,".deadband"))/2,onChange:function(e){var n=h("".concat(t,".deadband")),i=le+n/2,a=h("".concat(t,".heating")),o=h("".concat(t,".cooling")),c=e+n/2,s=(0,m.clamp)(c,a+i,o-i),r=je("all",{setpoint:s,deadband:n,heating:a,cooling:o});l("".concat(t),d)({setpoint:s,label:r})}}),(0,f.jsx)(u.Zz.Handle,{type:u.gZ.END,interactionKind:u.qB.LOCK,intentBefore:s.S.SUCCESS,intentAfter:s.S.PRIMARY,value:h("".concat(t,".setpoint"))+h("".concat(t,".deadband"))/2,onChange:function(e){var n=h("".concat(t,".deadband")),i=le+n/2,a=h("".concat(t,".heating")),o=h("".concat(t,".cooling")),c=e-n/2,s=(0,m.clamp)(c,a+i,o-i),r=je("all",{setpoint:s,deadband:n,heating:a,cooling:o});l("".concat(t),d)({setpoint:s,label:r})}})]})]})},g=function(){return(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:"Unoccupied"}),(0,f.jsxs)(u.Zz,{min:xe,max:me,stepSize:.5,labelStepSize:5,labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>ue&&e<pe?"".concat(e,"\xba\xa0F"):""},children:[(0,f.jsx)(u.Zz.Handle,{type:u.gZ.START,interactionKind:u.qB.LOCK,intentBefore:s.S.WARNING,value:h("".concat(t,".heating")),onChange:function(e){var n=h("".concat(t,".setpoint")),i=h("".concat(t,".deadband")),a=le+i/2,o=(0,m.clamp)(e,ue,n-a),c=h("".concat(t,".cooling")),s=je("all",{setpoint:n,deadband:i,heating:o,cooling:c});l("".concat(t),d)({heating:o,label:s})}}),(0,f.jsx)(u.Zz.Handle,{type:u.gZ.END,interactionKind:u.qB.LOCK,intentAfter:s.S.PRIMARY,value:h("".concat(t,".cooling")),onChange:function(e){var n=h("".concat(t,".setpoint")),i=h("".concat(t,".deadband")),a=le+i/2,o=h("".concat(t,".heating")),c=(0,m.clamp)(e,n+a,pe),s=je("all",{setpoint:n,deadband:i,heating:o,cooling:c});l("".concat(t),d)({cooling:c,label:s})}})]})]})};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("h3",{children:" "}),(0,f.jsx)("div",{className:"label",children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:i}),(0,f.jsx)(u.BZ,{type:"text",value:h("".concat(t,".label")),onChange:function(e){l("".concat(t,".label"),d)(e.target.value)},readOnly:null===r||void 0===r?void 0:r.includes("title")})]})}),(0,f.jsx)("div",{className:"deadband",children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:"Deadband"}),(0,f.jsx)(u.Af,{step:1,min:ce,max:se,value:h("".concat(t,".deadband")),onValueChange:function(e){var n=h("".concat(t,".setpoint")),i=e,a=h("".concat(t,".heating")),o=h("".concat(t,".cooling")),c=je("all",{setpoint:n,deadband:i,heating:a,cooling:o});l("".concat(t),d)({deadband:i,label:c})}})]})}),(0,f.jsx)("div",{className:"error",children:(0,f.jsx)("h4",{children:p})}),(0,f.jsx)("div",{})]}),function(){switch(n){case"both":return(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{className:"setpoint",children:v()}),(0,f.jsx)("div",{className:"break"}),(0,f.jsx)("div",{className:"setpoint",children:x()}),(0,f.jsx)("div",{className:"break"}),(0,f.jsx)("div",{className:"setpoint",children:g()}),(0,f.jsx)("div",{className:"break"}),(0,f.jsx)("div",{})]});case"single":return(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{className:"setpoint",children:v()}),(0,f.jsx)("div",{className:"break"}),(0,f.jsx)("div",{})]});default:return(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{className:"setpoint",children:x()}),(0,f.jsx)("div",{className:"break"}),(0,f.jsx)("div",{className:"setpoint",children:g()}),(0,f.jsx)("div",{className:"break"}),(0,f.jsx)("div",{})]})}}()]})}function Se(e){var n=e.unit,i=e.editing,t=e.handleChange;return(0,f.jsx)(be,{type:"separate",title:"Setpoints",path:"configuration.setpoint",unit:n,editing:i,setpoint:(0,m.get)(i,"configuration.setpoint"),handleChange:t})}var ye=i(95785),Ce=i(53381),Ne=function(e){return O()().format("dddd, MMMM Do YYYY")},Te=i(24824),Oe=function(e){(0,l.Z)(i,e);var n=(0,c.Z)(i);function i(e){var t;return(0,d.Z)(this,i),(t=n.call(this,e)).getValue=function(e,n,i){var a=t.props.units,d=i||(null===a||void 0===a?void 0:a.find((function(e){return e.id===(null===n||void 0===n?void 0:n.id)})));return(0,m.get)(n,e,(0,m.get)(d,e))},t.handleChange=function(e,n){return function(i){if("configurationId"===e)t.props.updateUnit({id:null===n||void 0===n?void 0:n.id,configurationId:i});else!function(i){n&&((0,m.isObject)(t.getValue(e,n))?(0,m.set)(n,e,(0,m.merge)((0,m.cloneDeep)((0,m.get)(n,e)),i)):(0,m.set)(n,e,i),t.setState({editing:n}))}(i)}},t.handleCreate=function(e){var n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ne(),n={label:"",setpoint:ge,deadband:re,heating:he,cooling:ve};n.label=je("all",n);var i={label:"",occupied:!0,startTime:L(w),endTime:L(B)};i.label=H("all",i);var t={label:"",occupied:!1,startTime:L(w),endTime:L(B)};t.label=H("all",t);var a=[y.R$.NewYearsDayType,y.R$.MartinLutherKingJrType,y.R$.PresidentsDayType,y.R$.MemorialDayType,y.R$.JuneteenthType,y.R$.IndependenceDayType,y.R$.LaborDayType,y.R$.ColumbusDayType,y.R$.VeteransDayType,y.R$.ThanksgivingType,y.R$.BlackFridayType,y.R$.ChristmasType].map((function(e){return e.name})),d=y.R$.values.map((function(e){return{label:e.label,type:a.includes(e.name)?"Enabled":"Disabled"}}));return{label:e,setpoint:n,mondaySchedule:i,tuesdaySchedule:i,wednesdaySchedule:i,thursdaySchedule:i,fridaySchedule:i,saturdaySchedule:t,sundaySchedule:t,holidaySchedule:t,holidays:d}}();n.unitId=e.id,t.props.createConfiguration(n),t.setState({editing:null,expanded:null})},t.handleEdit=function(e){var n=t.props.filtered,i=t.state.editing,a=i&&(null===n||void 0===n?void 0:n.find((function(e){return e.id===i.id})));a&&t.isSave(a)?t.setState({confirm:function(){return t.setState({editing:{id:e.id}})}}):t.setState({editing:{id:e.id}})},t.handleCancel=function(){var e=t.props.filtered,n=t.state.editing,i=n&&(null===e||void 0===e?void 0:e.find((function(e){return e.id===n.id})));i&&t.isSave(i)?t.setState({confirm:function(){return t.setState({editing:null,expanded:null})}}):t.setState({editing:null,expanded:null})},t.handleConfirm=function(){var e=t.state.confirm;t.setState({confirm:null},null!==e&&void 0!==e?e:void 0)},t.handleSave=function(){var e=t.state.editing;e&&t.props.updateUnit(e)},t.handleDelete=function(e){var n=e.id;void 0!==n&&t.props.deleteConfiguration(n)},t.handlePush=function(e){var n=e.id;void 0!==n&&t.props.updateUnit({id:n,stage:y.$b.UpdateType.label})},t.isSave=function(e){var n,i,a=t.state.editing,d=(0,m.merge)({},e,a);return!!((i=null===(n=d.configuration)||void 0===n?void 0:n.setpoint)&&(0,m.isNumber)(i.setpoint)&&(0,m.isNumber)(i.deadband)&&(0,m.isNumber)(i.heating)&&(0,m.isNumber)(i.cooling))&&void 0===fe(i)&&!(0,m.isEqual)(e,d)},t.isPush=function(e){switch(e.stage){case y.$b.UpdateType.label:case y.$b.DeleteType.label:case y.$b.ProcessType.label:return!1;case y.$b.CreateType.label:case y.$b.CompleteType.label:case y.$b.FailType.label:default:return!t.isSave(e)}},t.state={editing:null,expanded:null,confirm:null},t}return(0,o.Z)(i,[{key:"componentDidMount",value:function(){this.props.readUnits(),this.props.readConfigurations(),this.props.readUnitsPoll(Te.Jd),this.props.readConfigurationsPoll(Te.Jd)}},{key:"componentWillUnmount",value:function(){this.props.readUnitsPoll(),this.props.readConfigurationsPoll()}},{key:"renderStatus",value:function(e){var n=this,i=x.WNC,t=s.S.WARNING;switch(e.stage){case y.$b.UpdateType.label:i=x.RGM,t=s.S.PRIMARY;break;case y.$b.ProcessType.label:i=x.RGM,t=s.S.SUCCESS;break;case y.$b.CreateType.label:i=x.WNC,t=s.S.WARNING;break;case y.$b.DeleteType.label:i=x.yY6,t=s.S.DANGER;break;case y.$b.CompleteType.label:i=x.ae_,t=s.S.SUCCESS;break;case y.$b.FailType.label:i=x.pnR,t=s.S.DANGER}return(0,f.jsx)(ye.u,{content:"Push Unit Configuration",placement:r.Ly.TOP,disabled:!this.isPush(e),children:(0,f.jsx)(u.zx,{icon:i,intent:t,minimal:!0,onClick:function(){return n.handlePush(e)},disabled:!this.isPush(e)})})}},{key:"renderConfirm",value:function(){var e=this;return null===this.state.confirm?null:(0,f.jsx)(u.bZ,{intent:s.S.DANGER,isOpen:!0,confirmButtonText:"Yes",cancelButtonText:"Cancel",onConfirm:function(){return e.handleConfirm()},onClose:function(){return e.setState({confirm:null})},children:(0,f.jsx)("p",{children:"There are changes which have not been saved. Do you still want to continue?"})})}},{key:"renderPrompt",value:function(){var e=this.props.filtered,n=this.state.editing,i=n&&(null===e||void 0===e?void 0:e.find((function(e){return e.id===n.id}))),t=!(0,m.isNil)(i)&&this.isSave(i);return(0,f.jsx)(h.NL,{when:t,message:"There are changes which have not been saved. Do you still want to continue?"})}},{key:"render",value:function(){var e=this,n=this.props,i=n.filtered,a=n.configurations,d=this.state,o=d.editing,l=d.expanded;return(0,f.jsxs)("div",{className:"units",children:[this.renderPrompt(),(0,f.jsx)(h.h4,(0,t.Z)({},this.props)),(0,f.jsx)("h1",{children:"Units"}),(0,f.jsxs)("div",{className:"list",children:[null===i||void 0===i?void 0:i.map((function(n,i){var t,d;return n.id===(null===o||void 0===o?void 0:o.id)?(0,f.jsxs)(u.Zb,{interactive:!0,children:[(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{children:(0,f.jsx)(u.__,{children:(0,f.jsx)("h3",{children:n.label})})}),(0,f.jsxs)("div",{children:[e.renderStatus(n),(0,f.jsx)(ye.u,{content:"Save",placement:r.Ly.TOP,disabled:!e.isSave(n),children:(0,f.jsx)(u.zx,{icon:x.$eC,intent:s.S.PRIMARY,minimal:!0,onClick:function(){return e.handleSave()},disabled:!e.isSave(n)})}),(0,f.jsx)(ye.u,{content:"Exit",placement:r.Ly.TOP,children:(0,f.jsx)(u.zx,{icon:x.eV6,intent:s.S.PRIMARY,minimal:!0,onClick:function(){return e.handleCancel()}})})]})]}),(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:"Campus"}),(0,f.jsx)(u.BZ,{type:"text",value:n.campus,readOnly:!0})]})}),(0,f.jsx)("div",{children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:"Building"}),(0,f.jsx)(u.BZ,{type:"text",value:n.building,readOnly:!0})]})}),(0,f.jsx)("div",{children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:"System"}),(0,f.jsx)(u.BZ,{type:"text",value:n.system,readOnly:!0})]})}),(0,f.jsx)("div",{children:(0,f.jsxs)(u.__,{children:[(0,f.jsx)("b",{children:"Timezone"}),(0,f.jsx)(u.BZ,{type:"text",value:n.timezone,readOnly:!0})]})}),(0,f.jsx)("div",{})]}),(0,f.jsxs)(u.UO,{isOpen:!0,children:[(0,f.jsx)(u.mp,{contents:[{id:"configuration",label:"Configuration",icon:x.$qo,hasCaret:!0,isExpanded:"configuration"===l}],onNodeExpand:function(n){return e.setState({expanded:n.id})},onNodeCollapse:function(){return e.setState({expanded:null})},onNodeClick:function(n){return e.setState({expanded:n.id===l?null:n.id})}}),(0,f.jsx)(u.UO,{isOpen:"configuration"===l,children:(0,f.jsx)(b,{unit:n,editing:o,configurations:a,handleChange:e.handleChange,handleCreate:e.handleCreate})}),(0,f.jsx)(u.mp,{contents:[{id:"setpoints",label:"Setpoints",icon:x.IXo,hasCaret:!0,isExpanded:"setpoints"===l}],onNodeExpand:function(n){return e.setState({expanded:n.id})},onNodeCollapse:function(){return e.setState({expanded:null})},onNodeClick:function(n){return e.setState({expanded:n.id===l?null:n.id})}}),(0,f.jsx)(u.UO,{isOpen:"setpoints"===l,children:(0,f.jsx)(Se,{unit:n,editing:o,handleChange:e.handleChange})}),(0,f.jsx)(u.mp,{contents:[{id:"schedules",label:"Occupancy Schedules",icon:x.nfX,hasCaret:!0,isExpanded:"schedules"===l}],onNodeExpand:function(n){return e.setState({expanded:n.id})},onNodeCollapse:function(){return e.setState({expanded:null})},onNodeClick:function(n){return e.setState({expanded:n.id===l?null:n.id})}}),(0,f.jsx)(u.UO,{isOpen:"schedules"===l,children:(0,f.jsx)(oe,{unit:n,editing:o,handleChange:e.handleChange})}),(0,f.jsx)(u.mp,{contents:[{id:"holidays",label:"Holidays",icon:x.q4R,hasCaret:!0,isExpanded:"holidays"===l}],onNodeExpand:function(n){return e.setState({expanded:n.id})},onNodeCollapse:function(){return e.setState({expanded:null})},onNodeClick:function(n){return e.setState({expanded:n.id===l?null:n.id})}}),(0,f.jsx)(u.UO,{isOpen:"holidays"===l,children:(0,f.jsx)(E,{unit:n,editing:o,handleChange:e.handleChange})}),(0,f.jsx)(u.mp,{contents:[{id:"occupancies",label:"Temporary Occupancy",icon:x.SdJ,hasCaret:!0,isExpanded:"occupancies"===l}],onNodeExpand:function(n){return e.setState({expanded:n.id})},onNodeCollapse:function(){return e.setState({expanded:null})},onNodeClick:function(n){return e.setState({expanded:n.id===l?null:n.id})}}),(0,f.jsx)(u.UO,{isOpen:"occupancies"===l,children:(0,f.jsx)(V,{unit:n,editing:o,handleChange:e.handleChange})}),(0,f.jsx)(u.mp,{contents:[{id:"rtu",label:"RTU Configuration",icon:x.lt1,hasCaret:!0,isExpanded:"rtu"===l}],onNodeExpand:function(n){return e.setState({expanded:n.id})},onNodeCollapse:function(){return e.setState({expanded:null})},onNodeClick:function(n){return e.setState({expanded:n.id===l?null:n.id})}}),(0,f.jsx)(u.UO,{isOpen:"rtu"===l,children:(0,f.jsx)(Ce.f,{unit:n,editing:o,handleChange:e.handleChange,hidden:["peakLoadExclude","zoneLocation","zoneMass","zoneOrientation","zoneBuilding","coolingCapacity","compressors","heatPumpBackup","setpointPeakOffset"]})})]})]},null!==(t=n.id)&&void 0!==t?t:i):(0,f.jsx)(u.Zb,{interactive:!0,children:(0,f.jsxs)("div",{className:"row",children:[(0,f.jsx)("div",{children:(0,f.jsx)(u.__,{children:(0,f.jsx)("h3",{children:n.label})})}),(0,f.jsxs)("div",{children:[e.renderStatus(n),(0,f.jsx)(ye.u,{content:"Edit",placement:r.Ly.TOP,children:(0,f.jsx)(u.zx,{icon:x.dme,intent:s.S.PRIMARY,minimal:!0,onClick:function(){return e.handleEdit(n)}})})]})]})},null!==(d=n.id)&&void 0!==d?d:i)})),this.renderConfirm()]})]})}}]),i}(j.Component),ke={readUnits:v.Vh,readUnitsPoll:v.j5,filterUnits:v.Oe,updateUnit:v.t1,readConfigurations:p.uu,readConfigurationsPoll:p.z2,createConfiguration:p.Gx,updateConfiguration:p.a3,deleteConfiguration:p.Xc},Ze=(0,Z.$j)((function(e){return{units:(0,v.OB)(e),filtered:(0,v.ey)(e),configurations:(0,p.yp)(e)}}),ke)(Oe),ze=function(e){return(0,f.jsx)(a.Z,(0,t.Z)((0,t.Z)({},e),{},{renderRoute:function(e){return(0,f.jsx)(Ze,(0,t.Z)({},e))}}))}}}]);
//# sourceMappingURL=237.fb9303a3.chunk.js.map
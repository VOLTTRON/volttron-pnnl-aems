"use strict";(self.webpackChunkaems_client=self.webpackChunkaems_client||[]).push([[212],{65212:function(e,n,t){t.r(n),t.d(n,{default:function(){return ee}});var i=t(1413),a=t(9153),c=t(15671),d=t(43144),o=t(60136),l=t(43668),r=t(50698),s=t(32183),u=t(9418),h=t(36625),p=t(4481),x=t(97626),f=t(23122),g=t(763),v=t(99574),m=t(72791),j=t(80184);function b(e){var n,t=e.unit,i=e.editing,a=e.configurations,c=e.handleChange,d=e.handleCreate,o=(0,m.useCallback)((function(e){return(0,g.get)(i,e,(0,g.get)(t,e))}),[i,t]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{className:"configuration select",children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("h3",{children:"Select Configuration"}),(0,j.jsx)(v.p,{content:(0,j.jsxs)(u.v2,{children:[(0,j.jsx)(u.sN,{text:"New Configuration",onClick:function(){return d(t)}}),null===a||void 0===a?void 0:a.map((function(e){return(0,j.jsx)(u.sN,{text:e.label,onClick:function(){return c("configurationId",t)(e.id)}},e.id)}))]}),placement:"bottom-start",children:(0,j.jsx)(u.zx,{rightIcon:f.vv6,minimal:!0,children:(null===t||void 0===t||null===(n=t.configuration)||void 0===n?void 0:n.label)||"Select Configuration..."})})]})}),(0,j.jsx)("div",{})]}),(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{className:"label",children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:"Configuration Label"}),(0,j.jsx)(u.BZ,{type:"text",value:o("configuration.label"),onChange:function(e){return c("configuration.label",i)(e.target.value)}})]})}),(0,j.jsx)("div",{})]})]})}var C=t(29439),S=t(696),y=t(78719),N=t(42632),T=t(72426),O=t.n(T);function M(e){var n,t=e.path,i=e.unit,a=e.editing,c=e.holiday,d=e.handleChange,o=c.id,l=c.label,s=c.type,h=c.month,p=c.day,x=c.observance,v=(0,m.useCallback)((function(e){return(0,g.get)(a,e,(0,g.get)(i,e))}),[a,i]);if("Custom"===s){var b=x&&(null===(n=S.VD.parse(x))||void 0===n?void 0:n.label),C="".concat(O()().set("month",h-1).set("date",p).format("MMMM Do")," ").concat(b&&"(".concat(b,")"));return(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:l}),(0,j.jsx)(u.BZ,{type:"text",value:C,readOnly:!0})]})}),(0,j.jsx)("div",{children:(0,j.jsx)(u.zx,{icon:f.R4W,intent:r.S.WARNING,minimal:!0,onClick:function(){d(t,a)({id:o,type:s,action:"delete"})}})})]})})}return(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{className:"holiday",children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:l}),(0,j.jsx)(u.XZ,{label:"Enabled",checked:"Enabled"===v("".concat(t,".type")),onClick:function(){d("".concat(t),a)({id:v("".concat(t,".id")),type:"Enabled"===v("".concat(t,".type"))?"Disabled":"Enabled"})}})]})}),(0,j.jsx)("div",{})]})}var R=t(60364),Z=S.R$.values.map((function(e){return e.label}));function D(e){var n=e.unit,t=e.editing,i=e.handleChange,a=e.holidays,c=(0,m.useState)(""),d=(0,C.Z)(c,2),o=d[0],l=d[1],s=(0,m.useState)(new Date),h=(0,C.Z)(s,2),p=h[0],x=h[1],b=(0,m.useState)(""),y=(0,C.Z)(b,2),T=y[0],M=y[1],R=(0,m.useState)(!1),Z=(0,C.Z)(R,2),D=Z[0],E=Z[1];return(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{className:"label",children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:"Holiday Label"}),(0,j.jsx)(u.BZ,{type:"text",value:o,onChange:function(e){return l(e.target.value)}})]})}),(0,j.jsx)("div",{children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:"Date"}),(0,j.jsx)(v.p,{content:(0,j.jsx)(N.M,{value:p,onChange:function(e,n){e&&x(e),E(!n)}}),isOpen:D,placement:"bottom-start",children:(0,j.jsx)(u.zx,{rightIcon:f.XNV,onClick:function(){return E(!0)},minimal:!0,children:O()(p).format("MMMM Do")})})]})}),(0,j.jsx)("div",{children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:"Observance"}),(0,j.jsx)(v.p,{content:(0,j.jsxs)(u.v2,{children:[(0,j.jsx)(u.sN,{text:"Always on Date",onClick:function(){return M("")}}),S.VD.values.map((function(e){return(0,j.jsx)(u.sN,{text:e.label,onClick:function(){return M(e.label)}},e.name)}))]}),placement:"bottom-start",children:(0,j.jsx)(u.zx,{rightIcon:f.vv6,minimal:!0,children:T||"Always on Date"})})]})}),(0,j.jsx)("div",{children:(0,j.jsx)(u.zx,{icon:f.YZ9,intent:r.S.PRIMARY,minimal:!0,disabled:(0,g.isEmpty)(o)||void 0!==a.find((function(e){return e.label===o})),onClick:function(){var e,a=Math.max((0,g.get)(n,"configuration.holidays.length",0),(0,g.get)(t,"configuration.holidays.length",0));i("configuration.holidays.".concat(a),t)({type:"Custom",label:o,month:p.getMonth()+1,day:p.getDate(),observance:T,configurationId:null===n||void 0===n||null===(e=n.configuration)||void 0===e?void 0:e.id,createdAt:O()().format(),action:"create"}),l(""),x(new Date),M("")},children:"Create Holiday"})})]})}function E(e){var n,t=e.unit,i=e.editing,a=e.handleChange,c=(0,R.I0)(),d=(0,m.useState)(void 0),o=(0,C.Z)(d,2),l=o[0],s=o[1],h=(0,g.merge)([],null===(n=t.configuration)||void 0===n?void 0:n.holidays,(0,g.get)(i,"configuration.holidays"));return h.forEach((function(e,n){return e.index=n})),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(u.__,{children:[(0,j.jsx)("h3",{children:"Create Holiday"}),(0,j.jsx)(D,{unit:t,editing:i,handleChange:a,holidays:h})]}),(0,j.jsxs)(u.__,{children:[(0,j.jsx)("h3",{children:"Custom Holidays"}),(0,j.jsx)("ul",{children:(0,g.isEmpty)(h.filter((function(e){return"Custom"===e.type&&"delete"!==e.action})))?(0,j.jsx)("li",{children:"No Custom Holidays Defined"},"empty"):h.filter((function(e){return"Custom"===e.type&&"delete"!==e.action})).sort((function(e,n){return O()(n.createdAt).valueOf()-O()(e.createdAt).valueOf()})).map((function(e,n){return(0,j.jsx)("li",{children:(0,j.jsx)(M,{path:"configuration.holidays.".concat(e.index),unit:t,editing:i,holiday:e,handleChange:a},e.index)},e.index)}))})]}),(0,j.jsxs)(u.__,{children:[(0,j.jsx)("h3",{children:"Predefined Holidays"}),(0,j.jsx)("ul",{children:h.filter((function(e){return"Custom"!==e.type})).sort((function(e,n){return Z.indexOf(e.label)-Z.indexOf(n.label)})).map((function(e,n){return(0,j.jsx)("li",{children:(0,j.jsx)(M,{path:"configuration.holidays.".concat(e.index),unit:t,editing:i,holiday:e,handleChange:a},e.index)},e.index)}))})]}),(0,j.jsx)(u.bZ,{intent:r.S.DANGER,isOpen:void 0!==l,confirmButtonText:"Yes",cancelButtonText:"Cancel",onConfirm:function(){var e;return c((0,y.qd)(null!==(e=null===l||void 0===l?void 0:l.id)&&void 0!==e?e:-1))},onClose:function(){return s(void 0)},children:(0,j.jsxs)("p",{children:["Permanently delete the holiday ",null===l||void 0===l?void 0:l.label,"?"]})})]})}var z=t(63769),k=t(48565);function _(e){var n=e.path,t=e.editing,i=e.occupancy,a=e.handleChange,c=i.id,d=i.label,o=i.date,l=i.schedule,s=null===l||void 0===l?void 0:l.label,h="".concat(O()(o).format("dddd MMMM Do YYYY")," ").concat(s&&"(".concat(s,")")),p=O()(o).startOf("day").isBefore(O()().startOf("day"),"day");return(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{children:(0,j.jsxs)(u.__,{disabled:p,children:[(0,j.jsx)("b",{children:d}),(0,j.jsx)(u.BZ,{type:"text",value:h,disabled:p,readOnly:!0})]})}),(0,j.jsx)("div",{children:(0,j.jsx)(u.zx,{icon:f.R4W,intent:r.S.WARNING,minimal:!0,onClick:function(){a(n,t)({id:c,action:"delete"})}})})]})})}var B,A=t(50668),L=(0,A.parseBoolean)("false"),U={label:"",occupied:!0,startTime:(0,z.cz)(z.S$),endTime:(0,z.cz)(z.Be)};function w(e){var n=e.unit,t=e.editing,i=e.handleChange,a=(0,m.useState)(""),c=(0,C.Z)(a,2),d=c[0],o=c[1],l=(0,m.useState)(new Date),s=(0,C.Z)(l,2),h=s[0],p=s[1],x=(0,m.useState)((0,g.clone)(U)),b=(0,C.Z)(x,2),S=b[0],y=b[1],T=(0,m.useState)(!1),M=(0,C.Z)(T,2),R=M[0],Z=M[1],D=(0,m.useCallback)((function(e){return(0,g.get)(t,e,(0,g.get)(n,e))}),[t,n]),E=O()(h).format("dddd").toLowerCase(),k={schedule:{start:S.occupied?(0,z.xM)(S.startTime,!1):z.lL,end:S.occupied?(0,z.xM)(S.endTime,!0):z.QM},previous:{start:D("configuration.".concat(E,"Schedule.occupied"))?(0,z.xM)(D("configuration.".concat(E,"Schedule.startTime")),!1):z.lL,end:D("configuration.".concat(E,"Schedule.occupied"))?(0,z.xM)(D("configuration.".concat(E,"Schedule.endTime")),!0):z.QM,occupied:D("configuration.".concat(E,"Schedule.occupied"))}};return(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{className:"label",children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:"Occupancy Label"}),(0,j.jsx)(u.BZ,{type:"text",value:d,onChange:function(e){return o(e.target.value)}})]})}),(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{className:"label",children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:"Occupancy Schedule"}),(0,j.jsx)(u.BZ,{type:"text",value:S.label,readOnly:!0})]})}),(0,j.jsx)("div",{className:"occupancy",children:(0,j.jsxs)(u.Zz,{min:z.lL,max:z.QM,stepSize:5,labelStepSize:240,labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>z.lL&&e<z.QM?(0,z.li)(e):""},disabled:!S.occupied,children:[(0,j.jsx)(u.Zz.Handle,{type:u.gZ.START,interactionKind:u.qB.LOCK,intentAfter:S.occupied?r.S.SUCCESS:r.S.NONE,value:k.schedule.start,onChange:function(e){var n=(0,g.cloneDeep)(S),t=S.occupied,i=(0,z.xM)(S.endTime,!0),a=(0,g.clamp)(e,z.lL,Math.min(i,z.QM)-z.Ls),c=(0,z.sG)("all",{occupied:t,startTime:a,endTime:i});(0,g.merge)(n,{startTime:(0,z.cz)(a),label:c}),y(n)}}),(0,j.jsx)(u.Zz.Handle,{type:u.gZ.START,interactionKind:u.qB.NONE,intentAfter:k.previous.occupied?(0,g.inRange)(k.previous.start,k.schedule.start,k.schedule.end)?r.S.SUCCESS:r.S.PRIMARY:r.S.NONE,value:k.previous.start}),(0,j.jsx)(u.Zz.Handle,{type:u.gZ.END,interactionKind:u.qB.NONE,intentBefore:k.previous.occupied?(0,g.inRange)(k.previous.end,k.schedule.start,k.schedule.end)?r.S.SUCCESS:r.S.PRIMARY:r.S.NONE,value:k.previous.end}),(0,j.jsx)(u.Zz.Handle,{type:u.gZ.END,interactionKind:u.qB.LOCK,intentBefore:S.occupied?r.S.SUCCESS:r.S.NONE,value:k.schedule.end,onChange:function(e){var n=(0,g.cloneDeep)(S),t=S.occupied,i=(0,z.xM)(S.startTime,!1),a=(0,g.clamp)(e,Math.max(i,z.lL)+z.Ls,z.QM),c=(0,z.sG)("all",{occupied:t,startTime:i,endTime:a});(0,g.merge)(n,{endTime:(0,z.cz)(a),label:c}),y(n)}})]})}),L?(0,j.jsx)("div",{className:"unoccupied",children:(0,j.jsx)(u.XZ,{label:"Unoccupied",checked:!S.occupied,onClick:function(){var e=(0,g.cloneDeep)(S),n=!S.occupied,t=(0,z.xM)(S.startTime,!1),i=(0,z.xM)(S.endTime,!0),a=(0,z.sG)("all",{occupied:n,startTime:t,endTime:i});(0,g.merge)(e,{occupied:n,label:a}),y(e)}})}):(0,j.jsx)("div",{})]}),(0,j.jsx)("div",{children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:"Date"}),(0,j.jsx)(v.p,{content:(0,j.jsx)(N.M,{value:h,onChange:function(e,n){e&&p(e),Z(!n)}}),isOpen:R,placement:"bottom-start",children:(0,j.jsx)(u.zx,{rightIcon:f.XNV,onClick:function(){return Z(!0)},minimal:!0,children:O()(h).format("dddd MMMM Do YYYY")})})]})}),(0,j.jsx)("div",{children:(0,j.jsx)(u.zx,{icon:f.YZ9,intent:r.S.PRIMARY,minimal:!0,onClick:function(){var e,a=Math.max((0,g.get)(n,"configuration.occupancies.length",0),(0,g.get)(t,"configuration.occupancies.length",0));i("configuration.occupancies.".concat(a),t)({label:d,date:h.toISOString(),schedule:S,configurationId:null===n||void 0===n||null===(e=n.configuration)||void 0===e?void 0:e.id,createdAt:O()().format(),action:"create"}),o(""),p(new Date),y((0,g.clone)(U))},children:"Create Occupancy"})})]})}function I(e){var n,t=e.unit,i=e.editing,a=e.handleChange,c=(0,R.I0)(),d=(0,m.useState)(void 0),o=(0,C.Z)(d,2),l=o[0],s=o[1],h=(0,g.merge)([],null===(n=t.configuration)||void 0===n?void 0:n.occupancies,(0,g.get)(i,"configuration.occupancies"));return h.forEach((function(e,n){return e.index=n})),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(u.__,{children:[(0,j.jsx)("h3",{children:"Create Occupancy"}),(0,j.jsx)(w,{unit:t,editing:i,handleChange:a})]}),(0,j.jsxs)(u.__,{children:[(0,j.jsx)("h3",{children:"Temporary Occupancies"}),(0,j.jsx)("ul",{children:(0,g.isEmpty)(h.filter((function(e){return"delete"!==e.action})))?(0,j.jsx)("li",{children:"No Temporary Occupancies Defined"},"empty"):h.filter((function(e){return"delete"!==e.action})).sort((function(e,n){return O()(n.date).valueOf()-O()(e.date).valueOf()})).map((function(e,n){return(0,j.jsx)("li",{children:(0,j.jsx)(_,{path:"configuration.occupancies.".concat(e.index),unit:t,editing:i,occupancy:e,handleChange:a},e.index)},e.index)}))})]}),(0,j.jsx)(u.bZ,{intent:r.S.DANGER,isOpen:void 0!==l,confirmButtonText:"Yes",cancelButtonText:"Cancel",onConfirm:function(){var e;return c((0,k.VT)(null!==(e=null===l||void 0===l?void 0:l.id)&&void 0!==e?e:-1))},onClose:function(){return s(void 0)},children:(0,j.jsxs)("p",{children:["Permanently delete the occupancy ",null===l||void 0===l?void 0:l.label,"?"]})})]})}function P(e){var n=e.title,t=e.path,i=e.unit,a=e.editing,c=e.handleChange,d=e.readOnly,o=void 0===d?["title"]:d,l=(0,m.useCallback)((function(e){return(0,g.get)(a,e,(0,g.get)(i,e))}),[a,i]);return(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("h3",{children:" "}),(0,j.jsx)("div",{className:"label",children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:n}),(0,j.jsx)(u.BZ,{type:"text",value:l("".concat(t,".label")),onChange:function(e){c("".concat(t,".label"),a)(e.target.value)},readOnly:null===o||void 0===o?void 0:o.includes("title")})]})}),(0,j.jsx)("div",{className:"schedule",children:(0,j.jsx)(u.U2,{min:z.lL,max:z.QM,stepSize:5,labelStepSize:240,intent:r.S.SUCCESS,value:l("".concat(t,".occupied"))?[(0,z.xM)(l("".concat(t,".startTime")),!1),(0,z.xM)(l("".concat(t,".endTime")),!0)]:[z.lL,z.lL],labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>z.lL&&e<z.QM?(0,z.li)(e):""},disabled:!(0,g.get)(a,"".concat(t,".occupied"),(0,g.get)(i,"".concat(t,".occupied"))),onChange:function(e){var n=l("".concat(t,".occupied")),i=(0,g.clamp)(e[0],z.lL,Math.min(e[1],z.QM)-z.Ls),d=(0,g.clamp)(e[1],Math.max(e[0],z.lL)+z.Ls,z.QM),o=(0,z.sG)("all",{occupied:n,startTime:i,endTime:d});c("".concat(t),a)({startTime:(0,z.cz)(i),endTime:(0,z.cz)(d),label:o})}})}),(0,j.jsx)("div",{className:"unoccupied",children:(0,j.jsx)(u.XZ,{label:"Unoccupied",checked:!l("".concat(t,".occupied")),onClick:function(){var e=!l("".concat(t,".occupied")),n=(0,z.xM)(l("".concat(t,".startTime")),!1),i=(0,z.xM)(l("".concat(t,".endTime")),!0),d=(0,z.sG)("all",{occupied:e,startTime:n,endTime:i});c("".concat(t),a)({occupied:e,label:d})}})})]})}U.label=(0,z.sG)("all",U);var $=(0,A.parseBoolean)(null!==(B="false")?B:"");function H(e){var n=e.unit,t=e.editing,i=e.handleChange;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(P,{title:"Monday Schedule",path:"configuration.mondaySchedule",unit:n,editing:t,handleChange:i}),(0,j.jsx)(P,{title:"Tuesday Schedule",path:"configuration.tuesdaySchedule",unit:n,editing:t,handleChange:i}),(0,j.jsx)(P,{title:"Wednesday Schedule",path:"configuration.wednesdaySchedule",unit:n,editing:t,handleChange:i}),(0,j.jsx)(P,{title:"Thursday Schedule",path:"configuration.thursdaySchedule",unit:n,editing:t,handleChange:i}),(0,j.jsx)(P,{title:"Friday Schedule",path:"configuration.fridaySchedule",unit:n,editing:t,handleChange:i}),(0,j.jsx)(P,{title:"Saturday Schedule",path:"configuration.saturdaySchedule",unit:n,editing:t,handleChange:i}),(0,j.jsx)(P,{title:"Sunday Schedule",path:"configuration.sundaySchedule",unit:n,editing:t,handleChange:i}),$&&(0,j.jsx)(P,{title:"Holiday Schedule",path:"configuration.holidaySchedule",unit:n,editing:t,handleChange:i})]})}var Y=t(49107);function G(e){var n=e.type,t=e.title,i=e.path,a=e.unit,c=e.editing,d=e.setpoint,o=e.handleChange,l=e.readOnly,s=void 0===l?["title"]:l,h=(0,m.useCallback)((function(e){return(0,g.get)(c,e,(0,g.get)(a,e))}),[c,a]),p=(0,m.useMemo)((function(){return(0,Y.qr)((0,g.merge)({},(0,g.get)(a,i),d))||"\xa0"}),[i,a,d]),x=function(){return(0,j.jsxs)(u.Zz,{min:Y.QG,max:Y.Of,stepSize:.5,labelStepSize:5,labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>Y.op&&e<Y.Ig?"".concat(e,"\xba\xa0F"):""},children:[(0,j.jsx)(u.Zz.Handle,{type:u.gZ.START,interactionKind:u.qB.LOCK,intentAfter:r.S.WARNING,value:h("".concat(i,".heating")),onChange:function(e){var n=h("".concat(i,".setpoint")),t=h("".concat(i,".deadband")),a=Y.ax+t/2,d=(0,g.clamp)(e,Y.op,n-a),l=h("".concat(i,".cooling")),r=(0,Y.hD)("all",{setpoint:n,deadband:t,heating:d,cooling:l});o("".concat(i),c)({heating:d,label:r})}}),(0,j.jsx)(u.Zz.Handle,{type:u.gZ.START,interactionKind:u.qB.LOCK,intentAfter:r.S.NONE,value:h("".concat(i,".setpoint"))-h("".concat(i,".deadband"))/2,onChange:function(e){var n=h("".concat(i,".deadband")),t=Y.ax+n/2,a=h("".concat(i,".heating")),d=h("".concat(i,".cooling")),l=e+n/2,r=(0,g.clamp)(l,a+t,d-t),s=(0,Y.hD)("all",{setpoint:r,deadband:n,heating:a,cooling:d});o("".concat(i),c)({setpoint:r,label:s})}}),(0,j.jsx)(u.Zz.Handle,{type:u.gZ.END,interactionKind:u.qB.LOCK,intentBefore:r.S.NONE,value:h("".concat(i,".setpoint"))+h("".concat(i,".deadband"))/2,onChange:function(e){var n=h("".concat(i,".deadband")),t=Y.ax+n/2,a=h("".concat(i,".heating")),d=h("".concat(i,".cooling")),l=e-n/2,r=(0,g.clamp)(l,a+t,d-t),s=(0,Y.hD)("all",{setpoint:r,deadband:n,heating:a,cooling:d});o("".concat(i),c)({setpoint:r,label:s})}}),(0,j.jsx)(u.Zz.Handle,{type:u.gZ.END,interactionKind:u.qB.LOCK,intentBefore:r.S.PRIMARY,value:h("".concat(i,".cooling")),onChange:function(e){var n=h("".concat(i,".setpoint")),t=h("".concat(i,".deadband")),a=Y.ax+t/2,d=h("".concat(i,".heating")),l=(0,g.clamp)(e,n+a,Y.Ig),r=(0,Y.hD)("all",{setpoint:n,deadband:t,heating:d,cooling:l});o("".concat(i),c)({cooling:l,label:r})}})]})},f=function(){return(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:"Occupied"}),(0,j.jsxs)(u.Zz,{min:Y.QG,max:Y.Of,stepSize:.5,labelStepSize:5,intent:r.S.SUCCESS,labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>Y.op&&e<Y.Ig?"".concat(e,"\xba\xa0F"):""},children:[(0,j.jsx)(u.Zz.Handle,{type:u.gZ.START,interactionKind:u.qB.LOCK,intentBefore:r.S.WARNING,intentAfter:r.S.SUCCESS,value:h("".concat(i,".setpoint"))-h("".concat(i,".deadband"))/2,onChange:function(e){var n=h("".concat(i,".deadband")),t=Y.ax+n/2,a=h("".concat(i,".heating")),d=h("".concat(i,".cooling")),l=e+n/2,r=(0,g.clamp)(l,a+t,d-t),s=(0,Y.hD)("all",{setpoint:r,deadband:n,heating:a,cooling:d});o("".concat(i),c)({setpoint:r,label:s})}}),(0,j.jsx)(u.Zz.Handle,{type:u.gZ.END,interactionKind:u.qB.LOCK,intentBefore:r.S.SUCCESS,intentAfter:r.S.PRIMARY,value:h("".concat(i,".setpoint"))+h("".concat(i,".deadband"))/2,onChange:function(e){var n=h("".concat(i,".deadband")),t=Y.ax+n/2,a=h("".concat(i,".heating")),d=h("".concat(i,".cooling")),l=e-n/2,r=(0,g.clamp)(l,a+t,d-t),s=(0,Y.hD)("all",{setpoint:r,deadband:n,heating:a,cooling:d});o("".concat(i),c)({setpoint:r,label:s})}})]})]})},v=function(){return(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:"Unoccupied"}),(0,j.jsxs)(u.Zz,{min:Y.QG,max:Y.Of,stepSize:.5,labelStepSize:5,labelRenderer:function(e,n){return null!==n&&void 0!==n&&n.isHandleTooltip||e>Y.op&&e<Y.Ig?"".concat(e,"\xba\xa0F"):""},children:[(0,j.jsx)(u.Zz.Handle,{type:u.gZ.START,interactionKind:u.qB.LOCK,intentBefore:r.S.WARNING,value:h("".concat(i,".heating")),onChange:function(e){var n=h("".concat(i,".setpoint")),t=h("".concat(i,".deadband")),a=Y.ax+t/2,d=(0,g.clamp)(e,Y.op,n-a),l=h("".concat(i,".cooling")),r=(0,Y.hD)("all",{setpoint:n,deadband:t,heating:d,cooling:l});o("".concat(i),c)({heating:d,label:r})}}),(0,j.jsx)(u.Zz.Handle,{type:u.gZ.END,interactionKind:u.qB.LOCK,intentAfter:r.S.PRIMARY,value:h("".concat(i,".cooling")),onChange:function(e){var n=h("".concat(i,".setpoint")),t=h("".concat(i,".deadband")),a=Y.ax+t/2,d=h("".concat(i,".heating")),l=(0,g.clamp)(e,n+a,Y.Ig),r=(0,Y.hD)("all",{setpoint:n,deadband:t,heating:d,cooling:l});o("".concat(i),c)({cooling:l,label:r})}})]})]})};return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("h3",{children:" "}),(0,j.jsx)("div",{className:"label",children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:t}),(0,j.jsx)(u.BZ,{type:"text",value:h("".concat(i,".label")),onChange:function(e){o("".concat(i,".label"),c)(e.target.value)},readOnly:null===s||void 0===s?void 0:s.includes("title")})]})}),(0,j.jsx)("div",{className:"deadband",children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:"Deadband"}),(0,j.jsx)(u.Af,{step:1,min:Y.bM,max:Y.iz,value:h("".concat(i,".deadband")),onValueChange:function(e){var n=h("".concat(i,".setpoint")),t=e,a=h("".concat(i,".heating")),d=h("".concat(i,".cooling")),l=(0,Y.hD)("all",{setpoint:n,deadband:t,heating:a,cooling:d});o("".concat(i),c)({deadband:t,label:l})}})]})}),(0,j.jsx)("div",{className:"error",children:(0,j.jsx)("h4",{children:p})}),(0,j.jsx)("div",{})]}),function(){switch(n){case"both":return(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{className:"setpoint",children:x()}),(0,j.jsx)("div",{className:"break"}),(0,j.jsx)("div",{className:"setpoint",children:f()}),(0,j.jsx)("div",{className:"break"}),(0,j.jsx)("div",{className:"setpoint",children:v()}),(0,j.jsx)("div",{className:"break"}),(0,j.jsx)("div",{})]});case"single":return(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{className:"setpoint",children:x()}),(0,j.jsx)("div",{className:"break"}),(0,j.jsx)("div",{})]});default:return(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{className:"setpoint",children:f()}),(0,j.jsx)("div",{className:"break"}),(0,j.jsx)("div",{className:"setpoint",children:v()}),(0,j.jsx)("div",{className:"break"}),(0,j.jsx)("div",{})]})}}()]})}function K(e){var n=e.unit,t=e.editing,i=e.handleChange;return(0,j.jsx)(G,{type:"separate",title:"Setpoints",path:"configuration.setpoint",unit:n,editing:t,setpoint:(0,g.get)(t,"configuration.setpoint"),handleChange:i})}var Q=t(95785),q=t(53381),F=t(77848),W=t(24824),V=function(e){(0,o.Z)(t,e);var n=(0,l.Z)(t);function t(e){var i;return(0,c.Z)(this,t),(i=n.call(this,e)).getValue=function(e,n,t){var a=i.props.units,c=t||(null===a||void 0===a?void 0:a.find((function(e){return e.id===(null===n||void 0===n?void 0:n.id)})));return(0,g.get)(n,e,(0,g.get)(c,e))},i.handleChange=function(e,n){return function(t){if("configurationId"===e)i.props.updateUnit({id:null===n||void 0===n?void 0:n.id,configurationId:t});else!function(t){n&&((0,g.isObject)(i.getValue(e,n))?(0,g.set)(n,e,(0,g.merge)((0,g.cloneDeep)((0,g.get)(n,e)),t)):(0,g.set)(n,e,t),i.setState({editing:n}))}(t)}},i.handleCreate=function(e){var n=(0,F.ER)();n.unitId=e.id,i.props.createConfiguration(n),i.setState({editing:null,expanded:null})},i.handleEdit=function(e){var n=i.props.filtered,t=i.state.editing,a=t&&(null===n||void 0===n?void 0:n.find((function(e){return e.id===t.id})));a&&i.isSave(a)?i.setState({confirm:function(){return i.setState({editing:{id:e.id}})}}):i.setState({editing:{id:e.id}})},i.handleCancel=function(){var e=i.props.filtered,n=i.state.editing,t=n&&(null===e||void 0===e?void 0:e.find((function(e){return e.id===n.id})));t&&i.isSave(t)?i.setState({confirm:function(){return i.setState({editing:null,expanded:null})}}):i.setState({editing:null,expanded:null})},i.handleConfirm=function(){var e=i.state.confirm;i.setState({confirm:null},null!==e&&void 0!==e?e:void 0)},i.handleSave=function(){var e=i.state.editing;e&&i.props.updateUnit(e)},i.handleDelete=function(e){var n=e.id;void 0!==n&&i.props.deleteConfiguration(n)},i.handlePush=function(e){var n=e.id;void 0!==n&&i.props.updateUnit({id:n,stage:S.$b.UpdateType.label})},i.isSave=function(e){var n,t=i.state.editing,a=(0,g.merge)({},e,t);return(0,Y.hQ)(null===(n=a.configuration)||void 0===n?void 0:n.setpoint)&&!(0,g.isEqual)(e,a)},i.isPush=function(e){switch(e.stage){case S.$b.UpdateType.label:case S.$b.DeleteType.label:case S.$b.ProcessType.label:return!1;case S.$b.CreateType.label:case S.$b.CompleteType.label:case S.$b.FailType.label:default:return!i.isSave(e)}},i.state={editing:null,expanded:null,confirm:null},i}return(0,d.Z)(t,[{key:"componentDidMount",value:function(){this.props.readUnits(),this.props.readConfigurations(),this.props.readUnitsPoll(W.Jd),this.props.readConfigurationsPoll(W.Jd)}},{key:"componentWillUnmount",value:function(){this.props.readUnitsPoll(),this.props.readConfigurationsPoll()}},{key:"renderStatus",value:function(e){var n=this,t=f.WNC,i=r.S.WARNING;switch(e.stage){case S.$b.UpdateType.label:t=f.RGM,i=r.S.PRIMARY;break;case S.$b.ProcessType.label:t=f.RGM,i=r.S.SUCCESS;break;case S.$b.CreateType.label:t=f.WNC,i=r.S.WARNING;break;case S.$b.DeleteType.label:t=f.yY6,i=r.S.DANGER;break;case S.$b.CompleteType.label:t=f.ae_,i=r.S.SUCCESS;break;case S.$b.FailType.label:t=f.pnR,i=r.S.DANGER}return(0,j.jsx)(Q.u,{content:"Push Unit Configuration",placement:s.Ly.TOP,disabled:!this.isPush(e),children:(0,j.jsx)(u.zx,{icon:t,intent:i,minimal:!0,onClick:function(){return n.handlePush(e)},disabled:!this.isPush(e)})})}},{key:"renderConfirm",value:function(){var e=this;return null===this.state.confirm?null:(0,j.jsx)(u.bZ,{intent:r.S.DANGER,isOpen:!0,confirmButtonText:"Yes",cancelButtonText:"Cancel",onConfirm:function(){return e.handleConfirm()},onClose:function(){return e.setState({confirm:null})},children:(0,j.jsx)("p",{children:"There are changes which have not been saved. Do you still want to continue?"})})}},{key:"renderPrompt",value:function(){var e=this.props.filtered,n=this.state.editing,t=n&&(null===e||void 0===e?void 0:e.find((function(e){return e.id===n.id}))),i=!(0,g.isNil)(t)&&this.isSave(t);return(0,j.jsx)(h.NL,{when:i,message:"There are changes which have not been saved. Do you still want to continue?"})}},{key:"render",value:function(){var e=this,n=this.props,t=n.filtered,a=n.configurations,c=this.state,d=c.editing,o=c.expanded;return(0,j.jsxs)("div",{className:"units",children:[this.renderPrompt(),(0,j.jsx)(h.h4,(0,i.Z)({},this.props)),(0,j.jsx)("h1",{children:"Units"}),(0,j.jsxs)("div",{className:"list",children:[null===t||void 0===t?void 0:t.map((function(n,t){var i,c;return n.id===(null===d||void 0===d?void 0:d.id)?(0,j.jsxs)(u.Zb,{interactive:!0,children:[(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{children:(0,j.jsx)(u.__,{children:(0,j.jsx)("h3",{children:n.label})})}),(0,j.jsxs)("div",{children:[e.renderStatus(n),(0,j.jsx)(Q.u,{content:"Save",placement:s.Ly.TOP,disabled:!e.isSave(n),children:(0,j.jsx)(u.zx,{icon:f.$eC,intent:r.S.PRIMARY,minimal:!0,onClick:function(){return e.handleSave()},disabled:!e.isSave(n)})}),(0,j.jsx)(Q.u,{content:"Exit",placement:s.Ly.TOP,children:(0,j.jsx)(u.zx,{icon:f.eV6,intent:r.S.PRIMARY,minimal:!0,onClick:function(){return e.handleCancel()}})})]})]}),(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:"Campus"}),(0,j.jsx)(u.BZ,{type:"text",value:n.campus,readOnly:!0})]})}),(0,j.jsx)("div",{children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:"Building"}),(0,j.jsx)(u.BZ,{type:"text",value:n.building,readOnly:!0})]})}),(0,j.jsx)("div",{children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:"System"}),(0,j.jsx)(u.BZ,{type:"text",value:n.system,readOnly:!0})]})}),(0,j.jsx)("div",{children:(0,j.jsxs)(u.__,{children:[(0,j.jsx)("b",{children:"Timezone"}),(0,j.jsx)(u.BZ,{type:"text",value:n.timezone,readOnly:!0})]})}),(0,j.jsx)("div",{})]}),(0,j.jsxs)(u.UO,{isOpen:!0,children:[(0,j.jsx)(u.mp,{contents:[{id:"configuration",label:"Configuration",icon:f.$qo,hasCaret:!0,isExpanded:"configuration"===o}],onNodeExpand:function(n){return e.setState({expanded:n.id})},onNodeCollapse:function(){return e.setState({expanded:null})},onNodeClick:function(n){return e.setState({expanded:n.id===o?null:n.id})}}),(0,j.jsx)(u.UO,{isOpen:"configuration"===o,children:(0,j.jsx)(b,{unit:n,editing:d,configurations:a,handleChange:e.handleChange,handleCreate:e.handleCreate})}),(0,j.jsx)(u.mp,{contents:[{id:"setpoints",label:"Setpoints",icon:f.IXo,hasCaret:!0,isExpanded:"setpoints"===o}],onNodeExpand:function(n){return e.setState({expanded:n.id})},onNodeCollapse:function(){return e.setState({expanded:null})},onNodeClick:function(n){return e.setState({expanded:n.id===o?null:n.id})}}),(0,j.jsx)(u.UO,{isOpen:"setpoints"===o,children:(0,j.jsx)(K,{unit:n,editing:d,handleChange:e.handleChange})}),(0,j.jsx)(u.mp,{contents:[{id:"schedules",label:"Occupancy Schedules",icon:f.nfX,hasCaret:!0,isExpanded:"schedules"===o}],onNodeExpand:function(n){return e.setState({expanded:n.id})},onNodeCollapse:function(){return e.setState({expanded:null})},onNodeClick:function(n){return e.setState({expanded:n.id===o?null:n.id})}}),(0,j.jsx)(u.UO,{isOpen:"schedules"===o,children:(0,j.jsx)(H,{unit:n,editing:d,handleChange:e.handleChange})}),(0,j.jsx)(u.mp,{contents:[{id:"holidays",label:"Holidays",icon:f.q4R,hasCaret:!0,isExpanded:"holidays"===o}],onNodeExpand:function(n){return e.setState({expanded:n.id})},onNodeCollapse:function(){return e.setState({expanded:null})},onNodeClick:function(n){return e.setState({expanded:n.id===o?null:n.id})}}),(0,j.jsx)(u.UO,{isOpen:"holidays"===o,children:(0,j.jsx)(E,{unit:n,editing:d,handleChange:e.handleChange})}),(0,j.jsx)(u.mp,{contents:[{id:"occupancies",label:"Temporary Occupancy",icon:f.SdJ,hasCaret:!0,isExpanded:"occupancies"===o}],onNodeExpand:function(n){return e.setState({expanded:n.id})},onNodeCollapse:function(){return e.setState({expanded:null})},onNodeClick:function(n){return e.setState({expanded:n.id===o?null:n.id})}}),(0,j.jsx)(u.UO,{isOpen:"occupancies"===o,children:(0,j.jsx)(I,{unit:n,editing:d,handleChange:e.handleChange})}),(0,j.jsx)(u.mp,{contents:[{id:"rtu",label:"RTU Configuration",icon:f.lt1,hasCaret:!0,isExpanded:"rtu"===o}],onNodeExpand:function(n){return e.setState({expanded:n.id})},onNodeCollapse:function(){return e.setState({expanded:null})},onNodeClick:function(n){return e.setState({expanded:n.id===o?null:n.id})}}),(0,j.jsx)(u.UO,{isOpen:"rtu"===o,children:(0,j.jsx)(q.f,{unit:n,editing:d,handleChange:e.handleChange,hidden:["peakLoadExclude","zoneLocation","zoneMass","zoneOrientation","zoneBuilding","coolingCapacity","compressors","heatPumpBackup","coolingPeakOffset","heatingPeakOffset"]})})]})]},null!==(i=n.id)&&void 0!==i?i:t):(0,j.jsx)(u.Zb,{interactive:!0,children:(0,j.jsxs)("div",{className:"row",children:[(0,j.jsx)("div",{children:(0,j.jsx)(u.__,{children:(0,j.jsx)("h3",{children:n.label})})}),(0,j.jsxs)("div",{children:[e.renderStatus(n),(0,j.jsx)(Q.u,{content:"Edit",placement:s.Ly.TOP,children:(0,j.jsx)(u.zx,{icon:f.dme,intent:r.S.PRIMARY,minimal:!0,onClick:function(){return e.handleEdit(n)}})})]})]})},null!==(c=n.id)&&void 0!==c?c:t)})),this.renderConfirm()]})]})}}]),t}(m.Component),X={readUnits:x.Vh,readUnitsPoll:x.j5,filterUnits:x.Oe,updateUnit:x.t1,readConfigurations:p.uu,readConfigurationsPoll:p.z2,createConfiguration:p.Gx,updateConfiguration:p.a3,deleteConfiguration:p.Xc},J=(0,R.$j)((function(e){return{units:(0,x.OB)(e),filtered:(0,x.ey)(e),configurations:(0,p.yp)(e)}}),X)(V),ee=function(e){return(0,j.jsx)(a.Z,(0,i.Z)((0,i.Z)({},e),{},{renderRoute:function(e){return(0,j.jsx)(J,(0,i.Z)({},e))}}))}},77848:function(e,n,t){t.d(n,{LK:function(){return r},ER:function(){return u},kI:function(){return s}});var i=t(49107),a=t(63769),c=t(696),d=t(72426),o=t.n(d),l=t(763),r=function(e){return o()().format("dddd, MMMM Do YYYY")},s=function(e){return 0===(0,l.sum)(Object.values((null===e||void 0===e?void 0:e._count)||{}))},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r(),n={label:"",setpoint:i.Qf,deadband:i.tz,heating:i.cF,cooling:i.tE};n.label=(0,i.hD)("all",n);var t={label:"",occupied:!0,startTime:(0,a.cz)(a.S$),endTime:(0,a.cz)(a.Be)};t.label=(0,a.sG)("all",t);var d={label:"",occupied:!1,startTime:(0,a.cz)(a.S$),endTime:(0,a.cz)(a.Be)};d.label=(0,a.sG)("all",d);var o=[c.R$.NewYearsDayType,c.R$.MartinLutherKingJrType,c.R$.PresidentsDayType,c.R$.MemorialDayType,c.R$.JuneteenthType,c.R$.IndependenceDayType,c.R$.LaborDayType,c.R$.ColumbusDayType,c.R$.VeteransDayType,c.R$.ThanksgivingType,c.R$.BlackFridayType,c.R$.ChristmasType].map((function(e){return e.name})),l=c.R$.values.map((function(e){return{label:e.label,type:o.includes(e.name)?"Enabled":"Disabled"}}));return{label:e,setpoint:n,mondaySchedule:t,tuesdaySchedule:t,wednesdaySchedule:t,thursdaySchedule:t,fridaySchedule:t,saturdaySchedule:d,sundaySchedule:d,holidaySchedule:d,holidays:l}}},63769:function(e,n,t){t.d(n,{Ls:function(){return d},lL:function(){return o},S$:function(){return l},QM:function(){return r},Be:function(){return s},cz:function(){return p},li:function(){return x},xM:function(){return f},sG:function(){return g}});var i=t(763),a=t(72426),c=t.n(a),d=120,o=0,l=480,r=1440,s=1080,u="HH:mm",h="h:mm\xa0a",p=function(e){return c()("00:00",[u]).add(Math.trunc(e/60),"hours").add(e%60,"minutes").format(u)},x=function(e){return c()("00:00",[u]).add(Math.trunc(e/60),"hours").add(e%60,"minutes").format(h)},f=function(e,n){return 60*function(e,n,t){return t&&0===e?n:e}(c()(e,[u,h]).hours(),24,n)+c()(e,[u,h]).minutes()},g=function(e,n){var t=void 0===(null===n||void 0===n?void 0:n.occupied)||n.occupied,a=(0,i.isNumber)(n.startTime)?n.startTime:f(n.startTime,!1),c=(0,i.isNumber)(n.endTime)?n.endTime:f(n.endTime,!0);switch(e){case"startTime":return"".concat(x(a));case"endTime":return"".concat(x(c));default:return t?0===a&&1440===c?"Occupied All Day":"Occupied From Start Time: ".concat(x(a)," To End Time: ").concat(x(c)):"Unoccupied All Day"}}},49107:function(e,n,t){t.d(n,{ax:function(){return p},bM:function(){return x},iz:function(){return f},tz:function(){return g},op:function(){return v},cF:function(){return m},Ig:function(){return j},tE:function(){return b},QG:function(){return C},Of:function(){return S},Qf:function(){return y},hD:function(){return N},qr:function(){return T},hQ:function(){return O}});var i,a,c,d,o,l,r,s,u=t(763),h=t(696),p=parseInt("2"),x=(null===(i=h.g9.DeadbandType.options)||void 0===i?void 0:i.min)||2,f=(null===(a=h.g9.DeadbandType.options)||void 0===a?void 0:a.max)||6,g=(null===(c=h.g9.DeadbandType.options)||void 0===c?void 0:c.default)||4,v=(null===(d=h.g9.HeatingType.options)||void 0===d?void 0:d.min)||55,m=(null===(o=h.g9.HeatingType.options)||void 0===o?void 0:o.default)||60,j=(null===(l=h.g9.CoolingType.options)||void 0===l?void 0:l.max)||85,b=(null===(r=h.g9.CoolingType.options)||void 0===r?void 0:r.default)||80,C=v,S=j,y=(null===(s=h.g9.SetpointType.options)||void 0===s?void 0:s.default)||70,N=function e(n,t){return"all"===n?"Occupied Setpoint: ".concat(e("setpoint",t)," Deadband: ").concat(e("deadband",t)," Unoccupied Heating: ").concat(e("heating",t)," Cooling: ").concat(e("cooling",t)):"".concat(t[n],"\xba\xa0F")},T=function(e){return e.deadband<x||e.deadband>f?"Deadband must be in the range [".concat(x,",").concat(f,"]."):e.setpoint<e.heating+p+e.deadband/2||e.setpoint>e.cooling-p-e.deadband/2?"Occupied setpoint must be in the range [".concat(e.heating+p+e.deadband/2,",").concat(e.cooling-p-e.deadband/2,"]"):e.heating<v||e.cooling>j?"Unoccupied heating and cooling must be in the range [".concat(v,",").concat(j,"]"):e.setpoint%.5!==0?"Occupied setpoint must be a whole or half degree.":e.deadband%1!==0?"Deadband must be a whole degree.":e.heating%.5!==0||e.cooling%.5!==0?"Unoccupied heating or cooling must be a whole or half degree.":void 0},O=function(e){return!!(e&&(0,u.isNumber)(e.setpoint)&&(0,u.isNumber)(e.deadband)&&(0,u.isNumber)(e.heating)&&(0,u.isNumber)(e.cooling))&&void 0===T(e)}}}]);
//# sourceMappingURL=212.9c1810e6.chunk.js.map
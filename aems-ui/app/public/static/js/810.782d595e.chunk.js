"use strict";(self.webpackChunkaems_client=self.webpackChunkaems_client||[]).push([[810],{74810:function(e,n,i){i.r(n),i.d(n,{default:function(){return G}});var t=i(1413),s=i(93433),r=i(4942),a=i(15671),l=i(43144),d=i(60136),o=i(43668),c=i(9418),u=i(50698),h=i(36625),v=i(23122),m=i(72791),p=i(60364),f=i(763),x=i(46513),g=i(17113),j=i(696),w=i(64695),y=i(43334),A=i(85084),k=i(62333),C=i(95785),N=i(80184),S={dictionary:(0,t.Z)((0,t.Z)({},y.F),A.F),graphs:y.x,translations:k.Z};w.Mu.setOptions(S);var b=function(e){(0,d.Z)(i,e);var n=(0,o.Z)(i);function i(e){var t;return(0,a.Z)(this,i),(t=n.call(this,e)).handleChange=function(e,n){return function(i){var s,a=t.state.editing;switch(e){case"role":var l=void 0===n?t.state.role:(0,f.get)(a,"role",null!==(s=null===n||void 0===n?void 0:n.role)&&void 0!==s?s:"");i=(0,f.xor)(l.split(" "),[i]).join(" ");case"name":case"email":case"password":case"verify":return t.setState(void 0===n?(0,r.Z)({},e,i):{editing:(0,f.merge)(a,(0,r.Z)({},e,i))});default:throw new Error("Unhandled field passed to handleChange function.")}}},t.handleCreate=function(){var e=t.state,n=e.name,i=e.email,s=e.role,r=e.password;t.props.createUser({name:n,email:i,role:s,password:r}),t.setState({name:"",email:"",role:"",password:"",verify:"",editing:null,show:null})},t.handleEdit=function(e){var n=e.id;t.setState({editing:{id:n,password:"",verify:""}})},t.handleCancel=function(){t.setState({editing:null})},t.handleSave=function(){var e,n,i,r=t.props.user,a=(0,f.omit)(null===(e=t.state)||void 0===e?void 0:e.editing,["verify"].concat((0,s.Z)(null!==(n=t.state)&&void 0!==n&&null!==(i=n.editing)&&void 0!==i&&i.password?[]:["password"])));t.isAdmin()?(a&&t.props.updateUser(a),t.setState({editing:null})):(a&&t.props.updateCurrent(a),t.setState({editing:r?{id:r.id,password:"",verify:""}:null}))},t.handleDelete=function(e){var n=e.id;void 0!==n&&t.props.deleteUser(n)},t.state={name:"",email:"",role:"",password:"",verify:"",editing:null,show:null},t}return(0,l.Z)(i,[{key:"componentDidMount",value:function(){var e=this.props.user;this.isAdmin()?this.props.readUsers():this.setState({editing:e?{id:e.id,password:"",verify:""}:null})}},{key:"isCreate",value:function(){var e,n=this.state,i=n.name,t=n.email,s=n.role,r=n.password,a=n.verify;if(!(i&&t&&r))return!1;var l=this.getErrors(i,t,s,r,a);return!(l.email||l.name||l.verify||(null===(e=l.password)||void 0===e?void 0:e.feedback.warning))}},{key:"isSave",value:function(e){var n,i=this.state.editing,t=(0,f.merge)({verify:""},e,this.state.editing),s=t.name,r=t.email,a=t.role,l=t.password,d=t.verify,o=this.getErrors(s,r,a,l,d),c=(0,f.merge)({},e,i),u=o.email||o.name||o.verify||(null===(n=o.password)||void 0===n?void 0:n.feedback.warning),h=!(0,f.isEqual)((0,f.merge)({password:""},e),(0,f.omit)(c,["verify"]));return!u&&h}},{key:"isAdmin",value:function(){var e,n,i=this.props.user;return(e=j.GD.Admin).granted.apply(e,(0,s.Z)(null!==(n=null===i||void 0===i?void 0:i.role.split(" "))&&void 0!==n?n:[""]))}},{key:"parseRole",value:function(e){return{roles:e.split(" ").map((function(e){var n;return null===(n=j.GD.parse(e))||void 0===n?void 0:n.name})).filter((function(e){return!!e})),grants:(0,f.uniq)((0,f.flatten)(e.split(" ").map((function(e){var n;return null===(n=j.GD.parse(e))||void 0===n?void 0:n.grants})))).filter((function(e){return!!e}))}}},{key:"getErrors",value:function(e,n,i,t,s){return{name:""!==e&&e.length<2?"User name must be specified.":null,email:""===n||/^[\w-.]+@([\w-]+\.)+[\w-]{2,4}$/i.test(n)?null:"Valid email must be specified.",password:""===t?null:(0,w.tu)(null!==t&&void 0!==t?t:"",[e,n]),verify:""===t||t===s?null:"New password and verify password must match."}}},{key:"renderAccount",value:function(e){var n=this,i=this.state.show,t=e?(0,f.merge)({verify:""},e,this.state.editing):this.state,s=t.name,r=t.email,a=t.role,l=t.password,d=t.verify,o=this.parseRole(a),h=o.roles,m=o.grants,p=e?"edit-pw":"create-pw",x=e?"edit-pwv":"create-pwv",g=this.getErrors(s,r,a,l,d);return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsxs)("div",{children:[(0,N.jsxs)(c.__,{children:[(0,N.jsx)("b",{children:"Name"}),(0,N.jsx)(c.BZ,{type:"text",value:s,onChange:function(i){return n.handleChange("name",e)(i.target.value)},readOnly:!this.isAdmin(),intent:g.name?u.S.DANGER:void 0,rightElement:(0,N.jsx)("div",{className:"icons",children:g.name&&(0,N.jsx)(C.u,{content:g.name,children:(0,N.jsx)(c.JO,{className:"icon",icon:v.AlY,intent:u.S.DANGER})})})})]}),(0,N.jsxs)(c.__,{children:[(0,N.jsx)("b",{children:"Email"}),(0,N.jsx)(c.BZ,{type:"text",value:r,onChange:function(i){return n.handleChange("email",e)(i.target.value)},readOnly:!this.isAdmin(),intent:g.email?u.S.DANGER:void 0,rightElement:(0,N.jsx)("div",{className:"icons",children:g.email&&(0,N.jsx)(C.u,{content:g.email,children:(0,N.jsx)(c.JO,{className:"icon",icon:v.AlY,intent:u.S.DANGER})})})})]})]}),(0,N.jsxs)("div",{children:[(0,N.jsxs)(c.__,{children:[(0,N.jsx)("b",{children:"New Password"}),(0,N.jsx)(c.BZ,{type:i===p?"text":"password",autoComplete:"new-password",value:l,onChange:function(i){return n.handleChange("password",e)(i.target.value)},intent:g.password&&(g.password.feedback.warning||g.password.feedback.suggestions.length>0)?g.password.feedback.warning?u.S.DANGER:u.S.WARNING:void 0,rightElement:(0,N.jsxs)("div",{className:"icons",children:[g.password&&(g.password.feedback.warning||g.password.feedback.suggestions.length>0)&&(0,N.jsx)(C.u,{content:g.password.feedback.warning||g.password.feedback.suggestions.join(" \n"),children:(0,N.jsx)(c.JO,{className:"icon",icon:v.AlY,intent:g.password.feedback.warning?u.S.DANGER:u.S.WARNING})}),(0,N.jsx)(c.zx,{minimal:!0,icon:i===p?v.Sk0:v.BF5,onClick:function(){return n.setState({show:i===p?null:p})}})]})})]}),(0,N.jsxs)(c.__,{children:[(0,N.jsx)("b",{children:"Verify Password"}),(0,N.jsx)(c.BZ,{type:i===x?"text":"password",value:d,onChange:function(i){return n.handleChange("verify",e)(i.target.value)},intent:g.verify?u.S.DANGER:void 0===g.verify?void 0:u.S.NONE,rightElement:(0,N.jsxs)("div",{className:"icons",children:[g.verify&&(0,N.jsx)(C.u,{content:g.verify,children:(0,N.jsx)(c.JO,{className:"icon",icon:v.AlY,intent:u.S.DANGER})}),(0,N.jsx)(c.zx,{minimal:!0,icon:i===x?v.Sk0:v.BF5,onClick:function(){return n.setState({show:i===x?null:x})}})]})})]})]}),(0,N.jsx)("div",{children:(0,N.jsxs)(c.__,{children:[(0,N.jsx)("b",{children:"Roles"}),j.GD.values.map((function(i){return(0,N.jsx)(c.XZ,{id:i.name,label:"".concat(i.label," Role"),checked:h.includes(i.name),indeterminate:!h.includes(i.name)&&m.includes(i.name),onChange:function(){return n.handleChange("role",e)(i.name)},disabled:!n.isAdmin()},"checkbox-".concat(i.name))}))]})})]})}},{key:"renderMyAccount",value:function(){var e=this.props.user;return this.isAdmin()||!e?null:(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("h2",{children:"My Account"}),(0,N.jsx)("div",{className:"create",children:(0,N.jsxs)(c.Zb,{interactive:!0,children:[this.renderAccount(e),(0,N.jsx)("div",{children:(0,N.jsx)(c.zx,{icon:v.$eC,intent:u.S.PRIMARY,minimal:!0,onClick:this.handleSave,disabled:!this.isSave(e)})})]})})]})}},{key:"renderCreateAccount",value:function(){return this.isAdmin()?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("h2",{children:"Create Account"}),(0,N.jsx)("div",{className:"create",children:(0,N.jsxs)(c.Zb,{interactive:!0,children:[this.renderAccount(),(0,N.jsx)("div",{children:(0,N.jsx)(c.zx,{icon:v.RPl,intent:u.S.PRIMARY,minimal:!0,onClick:this.handleCreate,disabled:!this.isCreate()})})]})})]}):null}},{key:"renderAccountList",value:function(){var e=this;if(!this.isAdmin())return null;var n=this.props.filtered,i=this.state.editing;return(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)("h1",{children:"Accounts"}),(0,N.jsx)("div",{className:"list",children:null===n||void 0===n?void 0:n.map((function(n,t){return n.id===(null===i||void 0===i?void 0:i.id)?(0,N.jsxs)(c.Zb,{interactive:!0,children:[e.renderAccount(n),(0,N.jsxs)("div",{children:[(0,N.jsx)(c.zx,{icon:v.$eC,intent:u.S.PRIMARY,minimal:!0,onClick:function(){return e.handleSave()},disabled:!e.isSave(n)}),(0,N.jsx)(c.zx,{icon:v.eV6,intent:u.S.PRIMARY,minimal:!0,onClick:function(){return e.handleCancel()}})]})]},n.id||t):(0,N.jsxs)(c.Zb,{interactive:!0,children:[(0,N.jsx)("div",{children:n.name}),(0,N.jsx)("div",{children:n.email}),(0,N.jsx)("div",{children:n.role}),(0,N.jsxs)("div",{children:[(0,N.jsx)(c.zx,{icon:v.dme,intent:u.S.PRIMARY,minimal:!0,onClick:function(){return e.handleEdit(n)}}),(0,N.jsx)(c.zx,{icon:v.R4W,intent:u.S.WARNING,minimal:!0,onClick:function(){return e.handleDelete(n)}})]})]},n.id||t)}))})]})}},{key:"render",value:function(){return(0,N.jsxs)("div",{className:"account",children:[(0,N.jsx)(h.h4,(0,t.Z)({},this.props)),this.renderMyAccount(),this.renderCreateAccount(),this.renderAccountList()]})}}]),i}(m.Component),R={readUsers:x._V,filterUsers:x.nv,createUser:x.r4,updateUser:x.Nq,deleteUser:x.h8,updateCurrent:g.Nq},Z=(0,p.$j)((function(e){return{user:(0,g.dy)(e),accounts:(0,x.YN)(e),filtered:(0,x.Gp)(e)}}),R)(b),E=i(9153),G=function(e){return(0,N.jsx)(E.Z,(0,t.Z)((0,t.Z)({},e),{},{renderRoute:function(e){return(0,N.jsx)(Z,(0,t.Z)({},e))}}))}}}]);
//# sourceMappingURL=810.782d595e.chunk.js.map